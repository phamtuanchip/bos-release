webpackJsonp([0,2,5,23],{1045:function(e,t,i){var a=i(1046);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i(937)("fa57b612",a,!0)},1046:function(e,t,i){t=e.exports=i(936)(!0),t.push([e.i,".el-table th[data-v-a85ac2c0]{background-color:#3e4548;color:#fff}.el-table--border td[data-v-a85ac2c0],.el-table--border th[data-v-a85ac2c0]{border-right:2px solid #f2f3f4}.el-dialog--center .el-dialog__header[data-v-a85ac2c0]{padding-top:10px;background-color:#3e4548;color:#fff}.el-tabs__header[data-v-a85ac2c0]{margin:0 0 5px!important}","",{version:3,sources:["/Users/yuukininomae/Sites/vue-crm3/src/components/static/SettingUsers.vue"],names:[],mappings:"AACA,8BACE,yBAA0B,AAC1B,UAAY,CACb,AACD,4EACE,8BAAgC,CACjC,AACD,uDACE,iBAAkB,AAClB,yBAA0B,AAC1B,UAAY,CACb,AACD,kCACE,wBAA2B,CAC5B",file:"SettingUsers.vue",sourcesContent:["\n.el-table th[data-v-a85ac2c0] {\n  background-color: #3e4548;\n  color: #fff;\n}\n.el-table--border td[data-v-a85ac2c0], .el-table--border th[data-v-a85ac2c0] {\n  border-right: 2px solid #f2f3f4;\n}\n.el-dialog--center .el-dialog__header[data-v-a85ac2c0] {\n  padding-top: 10px;\n  background-color: #3e4548;\n  color: #fff;\n}\n.el-tabs__header[data-v-a85ac2c0] {\n  margin: 0 0 5px !important;\n}\n"],sourceRoot:""}])},1047:function(e,t,i){"use strict";var a=i(56),n=i.n(a),s=i(57),o=i.n(s),r=i(58),l=i(109),c=i(287),u=i(291),d=i(54);t.a={components:{UserInfo:r.a,ChangeThePassword:l.a,FormCfg:c.a,UIUsers:u.a},data:function(){return{taskFormSettings:{},docFormSettings:{},activeName:"first",tableData:[],temp:[],centerDialogVisible:!1,tabPosition:"top",valueAction:"Hoạt động",valueNotAction:"",searchInput:"",crmContactFormSettings:{},crmLeadFormSettings:{},crmOrderFormSettings:{},crmActivityFormSettings:{},crmProductFormSettings:{},activeNameCRM:"CRM.contact",appInfo:{}}},watch:{searchInput:function(e){null==e||""==e.trim()?this.tableData=this.temp:this.tableData=this.tableData.filter(function(t){return t.Username.toLowerCase().indexOf(e.toLowerCase())>-1})}},methods:{getAppInfoParameter:function(){var e=this;return o()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.requestSetting("xSetting.Default.AppInfo").then(function(t){var i=t.reduce(function(e,t){return e[t.Code]=t,e},{});e.appInfo=i});case 2:case"end":return t.stop()}},t,e)}))()},search:function(e,t){t.filter(function(t){return t.Username.indexOf(e)>-1})},changePass:function(e,t){var i=t[e];this.$hub.$emit("set-modal-data","Thay đổi mật khẩu","70%",!0,"center",l.a,!1,"",i)},editUser:function(e,t){t[e];this.$hub.$emit("set-modal-data","Sửa thông tin người dùng","80%",!0,"center",r.a,!0,"",{action:"edit",item:this.userModel})},indexMethod:function(e){return e+1},getUsers:function(){var e=this,t={RequestAction:"SearchUserWithGroups",IncludedGroupManager:!0,RequestClass:"BPM",RequestDataType:"json",ConditionFields:"IncludedGroupManager;Group;Status;LoginName;UserId",StaticFields:"UserId;Username;LoginName;Description;Status;",DynamicFields:"Avatar;Facebook;Email;Skype;Birthday;Biography;WorkProcess;Telephone",StructFields:"GroupRoot;GroupRootName;PhoneId;PhoneGroup;Public;RoleRoot;RoleRootName;GroupManage;Notification",OrderFields:"LoginName ASC",GroupType:1,Status:1};this.$Utils.post(t).then(function(t){e.tableData=e.$Utils.getDataWithRoot(t,"Data.UserDS.User"),e.temp=e.tableData},function(e){})},getTaskDocumentFormSetting:function(){var e=this,t={RequestClass:"xBase",RequestAction:"Request",TotalRequests:2,R1_RequestTemplate:"SettingNew.SearchSetting",R1_ParentCode:"xSetting.Project.Form",R1_Level:4,R1_Code:this.appInfo["xSetting.Default.AppInfo.PermissionTask"].Value,R2_RequestTemplate:"SettingNew.SearchSetting",R2_ParentCode:"xSetting.Project.Form",R2_Level:4,R2_Code:this.appInfo["xSetting.Default.AppInfo.PermissionDocument"].Value,SessionId:this.sessionId};this.$Utils.post(t).then(function(t){e.taskFormSettings=e.$Utils.getDataWithRoot(t.R1,"Data.DynamicDS.Setting")[0],e.docFormSettings=e.$Utils.getDataWithRoot(t.R2,"Data.DynamicDS.Setting")[0]})},getCRMFormSetting:function(){var e=this,t={RequestClass:"xBase",RequestAction:"Request",TotalRequests:5,R1_RequestTemplate:"SettingNew.SearchSetting",R1_Code:this.appInfo["xSetting.Default.AppInfo.PermissionCRMContact"].Value,R2_RequestTemplate:"SettingNew.SearchSetting",R2_Code:this.appInfo["xSetting.Default.AppInfo.PermissionCRMLead"].Value,R3_RequestTemplate:"SettingNew.SearchSetting",R3_Code:this.appInfo["xSetting.Default.AppInfo.PermissionCRMOrder"].Value,R4_RequestTemplate:"SettingNew.SearchSetting",R4_Code:this.appInfo["xSetting.Default.AppInfo.PermissionCRMActivity"].Value,R5_RequestTemplate:"SettingNew.SearchSetting",R5_Code:this.appInfo["xSetting.Default.AppInfo.PermissionCRMProduct"].Value};this.$Utils.post(t).then(function(t){e.crmContactFormSettings=e.$Utils.getDataWithRoot(t.R1,"Data.DynamicDS.Setting")[0],e.crmLeadFormSettings=e.$Utils.getDataWithRoot(t.R2,"Data.DynamicDS.Setting")[0],e.crmOrderFormSettings=e.$Utils.getDataWithRoot(t.R3,"Data.DynamicDS.Setting")[0],e.crmActivityFormSettings=e.$Utils.getDataWithRoot(t.R4,"Data.DynamicDS.Setting")[0],e.crmProductFormSettings=e.$Utils.getDataWithRoot(t.R5,"Data.DynamicDS.Setting")[0]})}},created:function(){this.getAppInfoParameter().then(function(){}),this.getUsers()}}},1048:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-tabs",{attrs:{"tab-position":e.tabPosition},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"Người dùng",name:"first"}},[i("UIUsers")],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Phân quyền task",name:"second"}},["second"===e.activeName?i("FormCfg",{attrs:{selectedItem:e.taskFormSettings}}):e._e()],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Phân quyền tài liệu",name:"third"}},["third"===e.activeName?i("FormCfg",{attrs:{selectedItem:e.docFormSettings}}):e._e()],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Phân quyền CRM",name:"fourth"}},["fourth"===e.activeName?i("el-tabs",{attrs:{"tab-position":"top",type:"border-card"},model:{value:e.activeNameCRM,callback:function(t){e.activeNameCRM=t},expression:"activeNameCRM"}},[i("el-tab-pane",{attrs:{label:"Contact",name:"CRM.contact"}},["CRM.contact"===e.activeNameCRM?i("FormCfg",{attrs:{selectedItem:e.crmContactFormSettings}}):e._e()],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Lead",name:"CRM.lead"}},["CRM.lead"===e.activeNameCRM?i("FormCfg",{attrs:{selectedItem:e.crmLeadFormSettings}}):e._e()],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Activity",name:"CRM.activity"}},["CRM.activity"===e.activeNameCRM?i("FormCfg",{attrs:{selectedItem:e.crmActivityFormSettings}}):e._e()],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Order",name:"CRM.order"}},["CRM.order"===e.activeNameCRM?i("FormCfg",{attrs:{selectedItem:e.crmOrderFormSettings}}):e._e()],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Product",name:"CRM.product"}},["CRM.product"===e.activeNameCRM?i("FormCfg",{attrs:{selectedItem:e.crmProductFormSettings}}):e._e()],1)],1):e._e()],1)],1)],1)},n=[],s={render:a,staticRenderFns:n};t.a=s},1049:function(e,t,i){var a=i(1050);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i(937)("3589000e",a,!0)},1050:function(e,t,i){t=e.exports=i(936)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"SettingGroupAndProject.vue",sourceRoot:""}])},1051:function(e,t,i){"use strict";var a=i(290),n=i(973),s=i(280),o=i(1052);t.a={components:{Groups:a.a,GroupCategories:n.a,Project:s.a,DocumentCategories:o.a},data:function(){return{tabPosition:"top",activeName:"Groups"}},methods:{},created:function(){}}},1052:function(e,t,i){"use strict";var a=i(1053),n=i(1065),s=i(0),o=s(a.a,n.a,!1,null,null,null);t.a=o.exports},1053:function(e,t,i){"use strict";var a=i(1054),n=i(1062),s=i(7);t.a={components:{DocumentCategoryTree:a.a,CreateDocumentCategoryForm:n.a},data:function(){return{rootId:"",level:0,categories:[],treeData:{Name:"Danh mục nghiệp vụ",children:[],level:"0",Level:"5",collapseIcon:"fa fa-cog",expandIcon:"fa fa-cog"},formInline:{Name:"",ParentId:void 0,Parent:[]},rules:{Name:[{validator:function(e,t,i){void 0===t||""===t.trim()?i(new Error("Tên cần phải có")):i()},trigger:"blur"}]}}},methods:{handleChange:function(e){this.formInline.ParentId=e[e.length-1]},checkExits:function(){var e=this,t=this.$Lodash.cloneDeep(this.$singleRequest);t.R1_RequestTemplate="Setting.SearchBase",t.R1_ParentId=s.a.isEmpty(this.formInline.ParentId)?this.formInline.ParentId:this.rootId,t.R1_Level=parseInt(this.level)+1+this.formInline.Parent.length,s.a.post(t).then(function(t){var i=s.a.getDataWithRoot(t.R1,"Data.DynamicDS.Setting");if(i=i.filter(function(t){return t.Name.trim().toLowerCase()===e.formInline.Name.trim().toLowerCase()}),i.length>0)return s.a.showMessage("error","Tên đã tồn tại"),!1;e.save()})},save:function(){var e=this,t=this.formInline;s.a.isEmpty(t.ParentId)||(t.ParentId=this.$Lodash.cloneDeep(this.rootId));var i=this.$Lodash.cloneDeep(this.$singleRequest);i.R1_RequestTemplate="Setting.Insert",i.R1_Name=t.Name,i.R1_ReferenceId=t.ParentId,i.R1_NestedSetType="InsertLastChildNode",s.a.postCheckResult(i).then(function(i){s.a.linkToRoleEveryone([{Id:i.R1.Data,Caption:t.Name}]),e.formInline.Name="",e.formInline.Parent=[],e.formInline.ParentId=void 0,e.$hub.$emit("update-document-category-tree",t),e.init()})},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.checkExits()})},init:function(){var e=this,t={RequestClass:"xBase",RequestAction:"Request",TotalRequests:1,R1_RequestTemplate:"SettingNew.SearchSetting",R1_ParentCode:"xSetting.Project.Parameter.Category",R1_IncludedNestedSetParent:!0};this.$Utils.post(t).then(function(t){var i=[];i=e.$Utils.getDataWithRoot(t.R1,"Data.DynamicDS.Setting");var a=i.shift();e.rootId=a.Id,e.level=a.Level,e.categories=e.$Utils.createCustomTreeFromList(e.$Lodash.cloneDeep(i),"Id","ParentId","children",{Name:"label",Id:"value"},{})})}},mounted:function(){var e=this;this.init(),this.$hub.$on("update-document-category-selecttree",function(){e.init()})}}},1054:function(e,t,i){"use strict";function a(e){i(1055)}var n=i(1057),s=i(1061),o=i(0),r=a,l=o(n.a,s.a,!1,r,"data-v-cbd82ce0",null);t.a=l.exports},1055:function(e,t,i){var a=i(1056);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i(937)("07948e88",a,!0)},1056:function(e,t,i){t=e.exports=i(936)(!0),t.push([e.i,".document-categories .card[data-v-cbd82ce0]{margin-bottom:0}.document-categories .custom-tree-content[data-v-cbd82ce0]{position:relative;top:2px;z-index:1}.document-categories .custom-tree-content.exitChild[data-v-cbd82ce0]{margin-left:-7px}","",{version:3,sources:["/Users/yuukininomae/Sites/vue-crm3/src/components/dynamic/DocumentCategoryTree.vue"],names:[],mappings:"AACA,4CACE,eAAmB,CACpB,AACD,2DACE,kBAAmB,AACnB,QAAS,AACT,SAAW,CACZ,AACD,qEACI,gBAAkB,CACrB",file:"DocumentCategoryTree.vue",sourcesContent:["\n.document-categories .card[data-v-cbd82ce0] {\n  margin-bottom: 0px;\n}\n.document-categories .custom-tree-content[data-v-cbd82ce0] {\n  position: relative;\n  top: 2px;\n  z-index: 1;\n}\n.document-categories .custom-tree-content.exitChild[data-v-cbd82ce0] {\n    margin-left: -7px;\n}\n"],sourceRoot:""}])},1057:function(module,__webpack_exports__,__webpack_require__){"use strict";(function($){var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__(4),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty__=__webpack_require__(44),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty__),__WEBPACK_IMPORTED_MODULE_2__components_static_EditDocumentCategoryForm__=__webpack_require__(1058),__WEBPACK_IMPORTED_MODULE_3_vue_sortable_tree__=__webpack_require__(45);__webpack_exports__.a={components:__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty___default()({},__WEBPACK_IMPORTED_MODULE_3_vue_sortable_tree__.a.name,__WEBPACK_IMPORTED_MODULE_3_vue_sortable_tree__.a),props:["datasource","callback"],data:function(){return{Name:"",Parent:"",ListData:[],viewModel:{},treeData:{Name:"Danh mục tài liệu",children:[],level:"0",Level:"5",collapseIcon:"fa fa-cog",expandIcon:"fa fa-cog"}}},created:function(){var e=this;this.init(),this.$hub.$on("update-document-category-tree",function(){e.init()})},destroyed:function(){this.$hub.$off("update-document-category-tree")},mounted:function(){},methods:{addSetting:function(e){this.$set(e,"addNew",!0),this.$hub.$emit("set-modal-data","Thêm mới danh mục","30%",!0,"center",__WEBPACK_IMPORTED_MODULE_2__components_static_EditDocumentCategoryForm__.a,!1,"",e)},init:function(){var e=this,t=this.$Lodash.cloneDeep(this.$singleRequest);t.R1_RequestTemplate="Setting.SearchSetting",t.R1_ParentCode="xSetting.Project.Parameter.Category",t.R1_IncludedNestedSetParent=!0,this.$Utils.post(t).then(function(t){e.ListData=e.$Utils.getDataWithRoot(t.R1,"Data.DynamicDS.Setting"),e.$Utils.isEmpty(e.ListData,"0")&&(e.ParentId=e.$Lodash.cloneDeep(e.ListData[0].Id),e.ListData.shift(),e.PageKey=e.ListData[0],e.getSetting())})},getSetting:function getSetting(){var _this3=this;this.ListData=[];var request=this.$Lodash.cloneDeep(this.$singleRequest);request.R1_RequestTemplate="Setting.SearchSettingTree",request.R1_ParentCode="xSetting.Project.Parameter.Category",request.R2_RequestTemplate="Setting.SearchSetting",request.R2_ParentCode="xSetting.Project.Parameter.Category",request.TotalRequests=2,this.$Utils.postCheckResult(request).then(function(data){_this3.treeData.children=_this3.$Utils.getDataWithRoot(data.R1,"Data");var SourceList=_this3.$Utils.getDataWithRoot(data.R2,"Data.DynamicDS.Setting");if(_this3.$Utils.isEmpty(SourceList,"0"))var RootLevel=_this3.$Lodash.cloneDeep(SourceList[0].Level);$.each(SourceList,function(key,value){var index=key-1;_this3.ListData.push(value);var childRank=eval(value.Level-RootLevel);for(_this3.ListData[key].text="";childRank>0;)_this3.ListData[key].text+="|-- ",childRank--;_this3.ListData[key].text+=value.Name})})},consoleData:function(e){},changeState:function(e){this.$set(e,"$foldClose",!e.$foldClose)},changePosition:function(e){var t=this,i=this.$Lodash.cloneDeep(this.$singleRequest);if(i.R1_RequestTemplate="Setting.MoveNode",i.R1_Id=e.data.Id,e.afterParent.children&&e.afterParent.children.length>1){var a=0;$.each(e.afterParent.children,function(t,n){n.Id==e.data.Id&&t>0?(a=t-1,i.R1_ReferenceId=e.afterParent.children[a].Id,i.R1_NestedSetType="MoveToAfterAnother"):n.Id==e.data.Id&&0==t&&(a=1,i.R1_ReferenceId=e.afterParent.children[a].Id,i.R1_NestedSetType="MoveToBeforeAnother")})}else i.R1_ReferenceId=e.afterParent.Id,i.R1_NestedSetType="MoveToLastChildNode";this.$Utils.post(i).then(function(i){t.getAllLevel(e.afterParent.Level,e.data),t.$hub.$emit("update-document-category-tree-form")})},editCategory:function(e){this.$hub.$emit("set-modal-data","Sửa danh mục","30%",!0,"center",__WEBPACK_IMPORTED_MODULE_2__components_static_EditDocumentCategoryForm__.a,!1,"",e)},deleteSetting:function(e){var t=this;this.$confirm("Bạn có chăc chắn muốn xóa nghiệp vụ {0} này?".replace("{0}",e.Name),"Cảnh báo",{confirmButtonText:"Xóa",cancelButtonText:"Bỏ qua",type:"warning"}).then(function(){if(t.$Utils.isEmpty(e)){var i=t.$Lodash.cloneDeep(t.ListData);t.deleteItem(e,i)}}).catch(function(){})},deleteItem:function(e,t){var i=this,a=i.$Lodash.cloneDeep(i.$singleRequest);a.R1_RequestTemplate="Setting.Delete",a.R1_Id=e.Id,i.$Utils.postCheckResult(a).then(function(a){var n=!0;$.each(t,function(a,s){e.Id==s.ParentId&&(i.deleteItem(s,t),n=!1)}),!0===n&&(i.getSetting(),i.$hub.$emit("update-document-category-selecttree"))})},checkExits:function(){var e=this;this.Parent&&""!=this.Parent&&(this.objParent=this.ListData.filter(function(t){return t.Id==e.Parent})[0]);var t=this.$Lodash.cloneDeep(this.$singleRequest);t.R1_RequestTemplate="Setting.SearchSetting",t.R1_ParentCode="xSetting.Project.Parameter.Category",this.$Utils.post(t).then(function(t){var i=e.$Utils.getDataWithRoot(t.R1,"Data.DynamicDS.Setting");i=i.filter(function(t){return t.Name==e.Name}),i.length>0||e.insertSetting()})},insertSetting:function(e){var t=this,i=this.$Lodash.cloneDeep(this.$singleRequest);i.R1_RequestTemplate="Setting.Insert",i.R1_Name=this.Name,i.R1_ValueName=this.data.Name,i.R1_ReferenceId=this.$Utils.isEmpty(this.objParent)?this.objParent.Id:this.ParentId,i.R1_NestedSetType="InsertLastChildNode",this.$Utils.postCheckResult(i).then(function(e){t.$Utils.linkToRoleEveryone([{Id:e.R1.Data,Caption:t.Name}]),t.$Utils.isEmpty(t.objParent,"Level")?t.onSave(t.objParent.Level):t.onSave(5),t.Name=null,t.objParent=null,t.getSetting()})},updateDatagroup:function(){var e=this,t=this.$Lodash.cloneDeep(this.$singleRequest);t.TotalRequests=4,t.R1_RequestTemplate="SettingNew.SearchSetting",t.R1_Code="DataGroup.danh-sach-cong-viec.04b66",t.R2_RequestTemplate="SettingNew.SearchSetting",t.R2_ParentCode="xSetting.Project.Form",t.R2_Level="4",t.R2_Name="DataGroup.danh-sach-cong-viec.04b66",t.R3_RequestTemplate="SettingNew.SearchSetting",t.R3_ParentCode="xSetting.Project.List",t.R3_Level="4",t.R3_Name="DataGroup.danh-sach-cong-viec.04b66",t.R4_RequestTemplate="SettingNew.SearchSetting",t.R4_ParentCode="xSetting.Project.Filter",t.R4_Level="4",t.R4_Name="DataGroup.danh-sach-cong-viec.04b66",this.$Utils.post(t).then(function(t){e.SettingFilter=e.$Utils.getDataWithRoot(t.R1,"Data.DynamicDS.Setting")[0],e.$Utils.isEmpty(e.SettingFilter,"Description")&&"string"==typeof e.SettingFilter.Description&&(e.SettingFilter.Description=JSON.parse(e.SettingFilter.Description)),e.objFields={},e.sortedFilter=[];for(var i=1;i<=e.SettingFilter.Description.FCount;i++)1==i&&(e.FilterSettings=""),e.FilterSettings+=e.SettingFilter["F"+i],i==e.SettingFilter.Description.FCount&&(e.setFilterSetting=!0,e.FilterSetting=JSON.parse(e.FilterSettings),e.SettingFilter.Fields=e.FilterSetting);e.viewModel.ListModules=e.$Utils.getDataWithRoot(t.R2,"Data.DynamicDS.Setting"),e.viewModel.ListModules=e.viewModel.ListModules.concat(e.$Utils.getDataWithRoot(t.R3,"Data.DynamicDS.Setting")),e.viewModel.ListModules=e.viewModel.ListModules.concat(e.$Utils.getDataWithRoot(t.R4,"Data.DynamicDS.Setting")),e.viewModel.ListModules.forEach(function(e){if(void 0!=e.Description){e.Description=JSON.parse(e.Description),e.ObjectFields="";for(var t=1;t<=7;t++)void 0!=e["OF"+t]&&(e.ObjectFields+=e["OF"+t]);e.ObjectFields=JSON.parse(e.ObjectFields)}}),e.DatagroupSource=e.$Lodash.cloneDeep(e.viewModel.ListModules)})},onSave:function(e,t){var i=this,a=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.SettingFilter.Fields);if(e-=4,-1==a.indexOf("CategoriesLevel"+e)){var n={Caption:"Danh mục phòng ban cấp "+e,DataSource:"xDynamicData_Setting",FieldColumnType:"String",FieldStorageType:"Struct",FilterIsUsed:"true",FormDisplay:"- Danh mục phòng ban cấp "+e+" -",FormFieldType:"Hidden",FormIncludeSubmit:"true",FormValidate:"",ListButtonGroups:"",ListIsHidden:"true",Name:"CategoriesLevel"+e,PlaceHolder:"- Danh mục phòng ban "+e+" -",ReportIsUsed:"true"};this.SettingFilter.Fields.push(n),a=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.SettingFilter.Fields);var s=JSON.parse(this.SettingFilter.Value),o={Name:"CategoriesLevel"+e,ColumnType:"String",StorageType:"Struct"};s.push(o),this.SettingFilter.Value=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(s),this.sourceFields=this.$Lodash.cloneDeep(this.SettingFilter.Fields),delete this.SettingFilter.Fields;var r=0;this.SettingFilter.Description.FCount=0;for(var l=1;l<7;l++)a.length>r&&(this.SettingFilter["F"+l]=a.substring(r,r+9999),r=1e4*l-l,this.SettingFilter.Description.FCount=l);if(this.SettingFilter.Description=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.SettingFilter.Description),!this.$Utils.isEmpty(t)||0==t){var c=this.$Lodash.cloneDeep(this.$singleRequest);this.$Utils.updateParamsSingleRequest(c,this.$Lodash.cloneDeep(this.SettingFilter)),c.R1_RequestTemplate="SettingNew.Update",this.$Utils.post(c).then(function(e){i.saveModules()})}}},saveModules:function(){var e=this,t=this.$Lodash.cloneDeep(this.SettingFilter);t.Description=JSON.parse(t.Description),t.Description.Fields=this.$Lodash.cloneDeep(this.sourceFields);var i=this.$Lodash.cloneDeep(this.viewModel.ListModules),a=this.$Lodash.cloneDeep(this.$singleRequest);a.TotalRequests=0,i.forEach(function(i){a.TotalRequests++,i.ModuleType=i.Value,i.Description.DataGroupCaption=t.Caption,i.Description.RootData=t.Description.RootData,i.Description.DataSource=t.Description.DataSource,i.Description.AdditionConditions=t.Description.AdditionConditions,-1!=["Form","Filter","List"].indexOf(i.Description.ModuleType)&&(i.Description.Link=t.Description.Link),-1!=["Form","Filter"].indexOf(i.Description.ModuleType)&&(i.Description.Dependencies=t.Description.Dependencies);var n=["Multicheck","IndexDefault","Tool"];(e.$Lodash.cloneDeep(i.ObjectFields).forEach(function(e){for(var a=!1,s=0;s<t.Description.Fields.length;s++){var o=t.Description.Fields[s];if(e.Name==o.Name){a=!0;break}}-1!=["List"].indexOf(i.Description.ModuleType)&&(-1!=n.indexOf(e.Name)&&(a=!0),"true"==e.ManualCalculator&&(a=!0)),a||($.each(i.ObjectFields,function(t,a){e.Name==a.Name&&i.ObjectFields.splice(t,1)}),void 0!=i.Description.Groups&&i.Description.Groups.forEach(function(t){void 0!=t.ListFields&&-1!=t.ListFields.indexOf(e.Name)&&(t.ListFields=t.ListFields.replace(e.Name+";",""))}))}),e.$Utils.isEmpty(i.Description,"Buttons"))&&(e.$Lodash.cloneDeep(i.Description.Buttons).forEach(function(e){for(var a=!1,n=0;n<t.Description.Buttons.length;n++)t.Description.Buttons[n].Code==e.Code&&(a=!0);a||$.each(i.Description.Buttons,function(t,a){e.Code==a.Code&&i.Description.Buttons.splice(t,1)})}),i.Description.Buttons.forEach(function(e){i.Description.Buttons.forEach(function(t){t.Code==e.Code&&(e=t)})}));if(-1!=["Form","List"].indexOf(i.Description.ModuleType))for(var s=0;s<i.Description.Buttons.length;s++)t.Description.Buttons.forEach(function(e){i.Description.Buttons[s].Code==e.Code&&(i.Description.Buttons[s]=e)});i.Fields=e.$Lodash.cloneDeep(i.ObjectFields),i.Fields.forEach(function(i){t.Description.Fields.forEach(function(t){t.Name==i.Name&&($.each(t,function(t,a){e.$Utils.isEmpty(i[t])||(i[t]=a)}),e.$Utils.deleteAutoValue(i))})}),-1!=["Form","Filter"].indexOf(i.Description.ModuleType)?t.Description.Fields.forEach(function(t){e.$Utils.deleteAutoValue(t),"Hidden"==t.FormFieldType&&i.Fields.push(t),void 0!=t.DynamicText&&null!=t.DynamicText&&i.Fields.push({Name:t.DynamicText,FieldStorageType:"Dynamic"})}):t.Description.Fields.forEach(function(t){e.$Utils.deleteAutoValue(t),"true"==t.ListIsHidden&&i.Fields.push(t),void 0!=t.DynamicText&&null!=t.DynamicText&&i.Fields.push({Name:t.DynamicText,FieldStorageType:"Dynamic"})}),i.ObjectFields=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(i.ObjectFields);for(var o=0,r=0,s=1;s<7;s++)i.ObjectFields.length>o&&(i["OF"+s]=i.ObjectFields.substring(o,o+9999),o=1e4*s-s,r=s);i.Description.OFCount=r,delete i.ObjectFields,o=0,r=0,i.Fields=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(i.Fields);for(var s=1;s<7;s++)i.Fields.length>o&&(i["F"+s]=i.Fields.substring(o,o+9999),o=1e4*s-s,r=s);i.Description.FCount=r,delete i.Fields,i.Description=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(i.Description),a=e.$Utils.updateParamsSingleRequest(a,i,a.TotalRequests),a=e.$Utils.updateParamsSingleRequest(a,{RequestTemplate:"SettingNew.Update"},a.TotalRequests)}),this.$Utils.post(a).then(function(t){e.updateDatagroup()})},getAllLevel:function getAllLevel(parent,data){this.onSave(eval(parent)+1),this.$Utils.isEmpty(data.children)&&this.getAllLevel(eval(parent)+1,data.children)},checkParent:function(e){var t=this;if(this.$Utils.isEmpty(e,"$parent")){var i=this.$Lodash.cloneDeep(e.$parent);delete e.$parent,this.inputData.unshift(i),this.checkParent(e.$parent)}else{var a=this.$Lodash.cloneDeep(this.$singleRequest);a.TotalRequests=0,$.each(this.ListTask,function(e,i){if(t.$Utils.isEmpty(i,"CategoriesName")&&""!=i.Categories){var n=!1,s=t.$Lodash.cloneDeep(t.inputData),o=t.$Utils.isEmpty(i,"CategoriesName")?i.CategoriesName.split(";"):[];$.each(i.Categories.split(";"),function(e,i){if(""!=i){if(1==n){var a={};a.Id=i,a.Name=o[e],s.push(a)}i==t.inputData[t.inputData.length-1].Id&&(n=!0)}}),1==n&&(a["R"+[a.TotalRequests+1]+"_RequestTemplate"]="AG_Task_Task.Update",a["R"+[a.TotalRequests+1]+"_RequestDataGroup"]="DataGroup.danh-sach-cong-viec.04b66",a["R"+[a.TotalRequests+1]+"_RequestFields"]="Id;Index;Categories;Code;",a["R"+[a.TotalRequests+1]+"_Categories"]="",a["R"+[a.TotalRequests+1]+"_CategoriesName"]="",a["R"+[a.TotalRequests+1]+"_Id"]=i.Id,$.each(s,function(e,t){a["R"+[a.TotalRequests+1]+"_Categories"]+=e.Id+";",a["R"+[a.TotalRequests+1]+"_CategoriesName"]+=e.Name+";",a["R"+[a.TotalRequests+1]+"_CategoriesLevel"+[t+1]]=e.Id,a["R"+[a.TotalRequests+1]+"_RequestFields"]+="CategoriesLevel"+[t+1]+";"}),a.TotalRequests++)}}),this.$Utils.post(a)}}}}}).call(__webpack_exports__,__webpack_require__(2))},1058:function(e,t,i){"use strict";var a=i(1059),n=i(1060),s=i(0),o=s(a.a,n.a,!1,null,null,null);t.a=o.exports},1059:function(e,t,i){"use strict";var a=i(7);t.a={props:["data"],data:function(){return{rules:{Name:[{validator:function(e,t,i){""===t||""===t.trim()?i(new Error("Tên cần phải có")):i()},trigger:"blur"}]},model:{Id:this.data.Id,Name:this.data.Name,oldName:this.data.Name}}},components:{},created:function(){this.data.addNew&&(this.model={Name:"",ParentName:this.data.Name})},methods:{checkExits:function(){var e=this,t=this,i=this.$Lodash.cloneDeep(this.$singleRequest);a.a.isEmpty(t.model.oldName)&&t.model.oldName.trim()!==t.model.Name.trim()&&(i.R1_RequestTemplate="Setting.SearchBase",i.R1_ParentId=this.data.ParentId,i.R1_Level=parseInt(this.data.Level),a.a.post(i).then(function(i){var n=a.a.getDataWithRoot(i.R1,"Data.DynamicDS.Setting");if(n=n.filter(function(i){return i.Id!==e.data.Id&&i.Name.trim().toLowerCase()===t.model.Name.trim().toLowerCase()}),n.length>0)return a.a.showMessage("error","Tên đã tồn tại"),!1;e.save()})),this.data.addNew&&(i.R1_RequestTemplate="Setting.SearchBase",i.R1_ParentId="ada5f027-f66a-45c0-83e5-fe4a4cb65bb0",i.R1_Level=parseInt(this.data.Level)+1,a.a.post(i).then(function(i){var n=a.a.getDataWithRoot(i.R1,"Data.DynamicDS.Setting");if(n=n.filter(function(e){return e.Name.trim().toLowerCase()===t.model.Name.trim().toLowerCase()}),n.length>0)return a.a.showMessage("error","Tên đã tồn tại"),!1;e.save()}))},save:function(){var e=this,t=this.$Lodash.cloneDeep(this.$singleRequest);t.R1_RequestTemplate="Setting.Update",void 0===this.model.Id||""===this.model.Id?(t.R1_ReferenceId="0"===this.data.level?"ada5f027-f66a-45c0-83e5-fe4a4cb65bb0":this.data.Id,t.R1_RequestTemplate="Setting.Insert",t.R1_NestedSetType="InsertLastChildNode",t.R1_Name=this.model.Name):t=a.a.updateParamsSingleRequest(t,this.model),a.a.post(t).then(function(i){i.success?(a.a.showMessage("success",e.$toastMessage.updateItemPre+e.$toastMessage.updateItemSuf),"Setting.Insert"===t.R1_RequestTemplate&&a.a.linkToRoleEveryone([{Id:i.R1.Data,Caption:e.model.Name}]),e.$hub.$emit("update-document-category-tree"),e.$hub.$emit("update-document-category-selecttree"),e.$hub.$emit("close-modal")):a.a.showMessage("error",e.$toastMessage.updateItemFailed)})},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.checkExits()})}}}},1060:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"validateForm",attrs:{inline:!0,rules:e.rules,model:e.model,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"Tên danh mục",prop:"Name"}},[i("el-input",{attrs:{placeholder:"Tên danh mục"},model:{value:e.model.Name,callback:function(t){e.$set(e.model,"Name",t)},expression:"model.Name"}})],1),e._v(" "),e.data.addNew?i("el-form-item",{attrs:{label:"Danh mục cha"}},[i("el-input",{attrs:{placeholder:"Danh mục cha",disabled:""},model:{value:e.model.ParentName,callback:function(t){e.$set(e.model,"ParentName",t)},expression:"model.ParentName"}})],1):e._e(),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("validateForm")}}},[e._v("Lưu")])],1)],1)},n=[],s={render:a,staticRenderFns:n};t.a=s},1061:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"document-categories"},[i("b-card",[i("sortable-tree",{attrs:{data:e.treeData,mixinParentKey:"$parent",dragEnable:!0,closeStateKey:"$foldClose"},on:{changePosition:e.changePosition},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item;return[i("div",{staticClass:"custom-tree-content",class:{exitChild:a.children&&a.children.length}},[a.$foldClose&&a.children&&a.children.length?i("span",{on:{click:function(t){e.changeState(a)}}},[e._v("▶")]):!a.$foldClose&&a.children&&a.children.length?i("span",{on:{click:function(t){e.changeState(a)}}},[e._v("▼")]):e._e(),e._v(" "),i("span",{staticClass:"mr-3",on:{click:function(t){e.changeState(a)}}},[e._v(e._s(a.Name))]),e._v(" "),i("span",[i("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){e.addSetting(a)}}},[i("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}})]),e._v(" "),"0"!=a.level?i("span",[e._v("\n               | "),i("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){e.editCategory(a)}}},[i("i",{staticClass:"fa fa-pencil-square-o",attrs:{"aria-hidden":"true"}})]),e._v(" |\n              "),i("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){e.deleteSetting(a)}}},[i("i",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"}})])]):e._e()])])]}}])})],1)],1)},n=[],s={render:a,staticRenderFns:n};t.a=s},1062:function(e,t,i){"use strict";var a=i(1063),n=i(1064),s=i(0),o=s(a.a,n.a,!1,null,null,null);t.a=o.exports},1063:function(e,t,i){"use strict";var a=i(7);t.a={props:["groupcategories","rootId","Level","callback","grcategories"],data:function(){return{formInline:{Name:"",ParentId:void 0,Parent:[]},rules:{Name:[{validator:function(e,t,i){void 0===t||""===t.trim()?i(new Error("Tên cần phải có")):i()},trigger:"blur"}]}}},components:{},methods:{handleChange:function(e){this.formInline.ParentId=e[e.length-1]},checkExits:function(){var e=this,t=this.$Lodash.cloneDeep(this.$singleRequest);t.R1_RequestTemplate="Setting.SearchBase",t.R1_ParentId=a.a.isEmpty(this.formInline.ParentId)?this.formInline.ParentId:this.rootId,t.R1_Level=parseInt(this.Level)+1+this.formInline.Parent.length,a.a.post(t).then(function(t){var i=a.a.getDataWithRoot(t.R1,"Data.DynamicDS.Setting");if(i=i.filter(function(t){return t.Name.trim().toLowerCase()==e.formInline.Name.trim().toLowerCase()}),i.length>0)return a.a.showMessage("error","Tên đã tồn tại"),!1;e.save()})},save:function(){var e=this,t=this.formInline,i=this.$Lodash.cloneDeep(this.$singleRequest);i.R1_RequestTemplate="Setting.Insert",i.R1_Name=t.Name,i.R1_ReferenceId=a.a.isEmpty(t.ParentId)?t.ParentId:this.rootId,i.R1_NestedSetType="InsertLastChildNode",a.a.postCheckResult(i).then(function(i){a.a.linkToRoleEveryone([{Id:i.R1.Data,Caption:t.Name}]),e.formInline.Name="",e.formInline.Parent=[],e.formInline.ParentId=void 0,e.$hub.$emit("update-document-category-tree")})},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.checkExits()})}}}},1064:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"validateForm",attrs:{inline:!e.$isMobileDevice,rules:e.rules,"label-width":"130px",model:e.formInline}},[i("el-form-item",{attrs:{label:"Tên danh mục",prop:"Name"}},[i("el-input",{attrs:{placeholder:"Tên danh mục"},model:{value:e.formInline.Name,callback:function(t){e.$set(e.formInline,"Name",t)},expression:"formInline.Name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Danh mục cha"}},[i("el-cascader",{attrs:{options:e.groupcategories,placeholder:"Chọn","change-on-select":"",clearable:""},on:{change:e.handleChange},model:{value:e.formInline.Parent,callback:function(t){e.$set(e.formInline,"Parent",t)},expression:"formInline.Parent"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("validateForm")}}},[e._v("Lưu")])],1)],1)},n=[],s={render:a,staticRenderFns:n};t.a=s},1065:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",{ref:"validateForm",attrs:{inline:!e.$isMobileDevice,rules:e.rules,"label-width":"130px",model:e.formInline}},[i("el-form-item",{attrs:{label:"Tên danh mục",prop:"Name"}},[i("el-input",{attrs:{placeholder:"Tên danh mục"},model:{value:e.formInline.Name,callback:function(t){e.$set(e.formInline,"Name",t)},expression:"formInline.Name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Danh mục cha"}},[i("el-cascader",{attrs:{options:e.categories,placeholder:"Chọn","change-on-select":"",clearable:""},on:{change:e.handleChange},model:{value:e.formInline.Parent,callback:function(t){e.$set(e.formInline,"Parent",t)},expression:"formInline.Parent"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("validateForm")}}},[e._v("Lưu")])],1)],1),e._v(" "),i("DocumentCategoryTree",{attrs:{datasource:e.treeData}})],1)},n=[],s={render:a,staticRenderFns:n};t.a=s},1066:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-tabs",{attrs:{"tab-position":e.tabPosition},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"Phòng ban",name:"Groups"}},["Groups"==e.activeName?i("Groups"):e._e()],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Dự án",name:"Project"}},["Project"==e.activeName?i("Project"):e._e()],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Nghiệp vụ",name:"GroupCategories"}},["GroupCategories"==e.activeName?i("GroupCategories"):e._e()],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Danh mục tài liệu",name:"DocumentCategories"}},["DocumentCategories"==e.activeName?i("DocumentCategories"):e._e()],1)],1)],1)},n=[],s={render:a,staticRenderFns:n};t.a=s},1067:function(e,t,i){var a=i(1068);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i(937)("0c062be0",a,!0)},1068:function(e,t,i){t=e.exports=i(936)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"SettingUI.vue",sourceRoot:""}])},1069:function(e,t,i){"use strict";var a=i(973),n=i(282),s=i(286),o=i(285),r=i(289),l=i(284);t.a={components:{GroupCategories:a.a,ProjectCategories:n.a,UIPage:r.a,UIReport:l.a,UIList:s.a,UIFilter:o.a},data:function(){return{activeName:"first",tabPosition:"top",options:[{value:"Tham số công việc",label:"Tham số công việc"},{value:"Tham số tài liệu",label:"Tham số tài liệu"}],value4:""}},methods:{},mounted:function(){},destroyed:function(){},created:function(){}}},1070:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-tabs",{attrs:{"tab-position":e.tabPosition}},[i("el-tab-pane",{attrs:{label:"Trang"}},[i("UIPage")],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Báo cáo"}},[i("UIReport")],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Danh sách"}},[i("UIList")],1),e._v(" "),i("el-tab-pane",{attrs:{label:"Bộ lọc"}},[i("UIFilter")],1)],1)],1)},n=[],s={render:a,staticRenderFns:n};t.a=s},1204:function(e,t,i){var a=i(1205);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i(937)("2a2e45dd",a,!0)},1205:function(e,t,i){t=e.exports=i(936)(!0),t.push([e.i,".col-sm-5[data-v-00df9417]{padding:0 5px}","",{version:3,sources:["/Users/yuukininomae/Sites/vue-crm3/src/components/Setting.vue"],names:[],mappings:"AACA,2BACE,aAAqB,CACtB",file:"Setting.vue",sourcesContent:["\n.col-sm-5[data-v-00df9417] {\n  padding: 0 5px 0 5px;\n}\n"],sourceRoot:""}])},1206:function(e,t,i){"use strict";var a=i(943),n=i(944),s=i(945);t.a={components:{SettingUsers:a.default,SettingGroupAndProject:n.default,SettingUI:s.default},data:function(){return{activeName:"first",tabPosition:"top"}},methods:{},created:function(){}}},1207:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticStyle:{background:"#fff",padding:"5px"}},[i("router-link",{staticClass:"col-sm-5 text-right ",attrs:{to:"/setting-users"}},[i("i",{staticClass:"icon-user mgr5"}),e._v("Tài khoản")]),e._v(" "),i("router-link",{staticClass:"col-sm-5 text-right",attrs:{to:"/setting-group-project"}},[i("i",{staticClass:"icon-people mgr5"}),e._v("Phòng ban & Dự án\n    ")]),e._v(" "),i("router-link",{staticClass:"col-sm-5 text-right",attrs:{to:"/setting-ui"}},[i("i",{staticClass:"icon-screen-desktop mgr5"}),e._v("Giao diện")]),e._v(" "),i("router-link",{staticClass:"col-sm-5 text-right",attrs:{to:"/setting-param"}},[i("i",{staticClass:"fa fa-sliders",attrs:{"aria-hidden":"true"}}),e._v("\n      Tham số\n    ")])],1),e._v(" "),i("router-view")],1)},n=[],s={render:a,staticRenderFns:n};t.a=s},943:function(e,t,i){"use strict";function a(e){i(1045)}Object.defineProperty(t,"__esModule",{value:!0});var n=i(1047),s=i(1048),o=i(0),r=a,l=o(n.a,s.a,!1,r,"data-v-a85ac2c0",null);t.default=l.exports},944:function(e,t,i){"use strict";function a(e){i(1049)}Object.defineProperty(t,"__esModule",{value:!0});var n=i(1051),s=i(1066),o=i(0),r=a,l=o(n.a,s.a,!1,r,"data-v-93bb558e",null);t.default=l.exports},945:function(e,t,i){"use strict";function a(e){i(1067)}Object.defineProperty(t,"__esModule",{value:!0});var n=i(1069),s=i(1070),o=i(0),r=a,l=o(n.a,s.a,!1,r,"data-v-199a050c",null);t.default=l.exports},963:function(e,t,i){"use strict";function a(e){i(1204)}Object.defineProperty(t,"__esModule",{value:!0});var n=i(1206),s=i(1207),o=i(0),r=a,l=o(n.a,s.a,!1,r,"data-v-00df9417",null);t.default=l.exports},973:function(e,t,i){"use strict";var a=i(974),n=i(988),s=i(0),o=s(a.a,n.a,!1,null,null,null);t.a=o.exports},974:function(e,t,i){"use strict";var a=i(975),n=i(985);t.a={components:{GroupCategoryTree:a.a,CreateGroupCategoryForm:n.a},data:function(){return{categories:[],categoriesTree:[],rootId:"",centerDialogVisible:!1,item:{},treeData:{Name:"Danh mục nghiệp vụ",children:[],level:"0",Level:"5",collapseIcon:"fa fa-cog",expandIcon:"fa fa-cog"}}},methods:{delete:function(e){},loadCategories:function(){var e=this,t={RequestClass:"xBase",RequestAction:"Request",TotalRequests:1,R1_RequestTemplate:"SettingNew.SearchSetting",R1_ParentCode:"xSetting.Project.Parameter.Organization.Category",R1_IncludedNestedSetParent:!0};this.$Utils.post(t).then(function(t){var i=[];i=e.$Utils.getDataWithRoot(t.R1,"Data.DynamicDS.Setting"),e.categories=e.$Lodash.cloneDeep(i),e.rootId=e.$Lodash.cloneDeep(i[0].Id),e.categories.shift()})},closeDialog:function(){this.item={}}},destroyed:function(){this.$hub.$off("update-category-tree"),this.$hub.$off("update-category-tree-form"),this.$hub.$off("addNewCat")},created:function(){},mounted:function(){var e=this;this.loadCategories(),this.$hub.$on("update-category-tree",function(){e.loadCategories(),e.centerDialogVisible=!1}),this.$hub.$on("addNewCat",function(t){e.item=t,e.centerDialogVisible=!0}),this.$hub.$on("update-category-tree-form",function(){e.loadCategories()})},watch:{categories:function(e){this.categoriesTree=this.$Utils.createCustomTreeFromList(this.$Lodash.cloneDeep(e),"Id","ParentId","children",{Name:"label",Id:"value"},{})}}}},975:function(e,t,i){"use strict";function a(e){i(976)}var n=i(978),s=i(984),o=i(0),r=a,l=o(n.a,s.a,!1,r,"data-v-3d49ae92",null);t.a=l.exports},976:function(e,t,i){var a=i(977);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i(937)("bcc4e0c4",a,!0)},977:function(e,t,i){t=e.exports=i(936)(!0),t.push([e.i,".group-categories .card[data-v-3d49ae92]{margin-bottom:0}.group-categories .custom-tree-content[data-v-3d49ae92]{position:relative;top:2px;z-index:1}.group-categories .custom-tree-content.exitChild[data-v-3d49ae92]{margin-left:-7px}","",{version:3,sources:["/Users/yuukininomae/Sites/vue-crm3/src/components/dynamic/GroupCategoryTree.vue"],names:[],mappings:"AACA,yCACE,eAAmB,CACpB,AACD,wDACE,kBAAmB,AACnB,QAAS,AACT,SAAW,CACZ,AACD,kEACI,gBAAkB,CACrB",file:"GroupCategoryTree.vue",sourcesContent:["\n.group-categories .card[data-v-3d49ae92] {\n  margin-bottom: 0px;\n}\n.group-categories .custom-tree-content[data-v-3d49ae92] {\n  position: relative;\n  top: 2px;\n  z-index: 1;\n}\n.group-categories .custom-tree-content.exitChild[data-v-3d49ae92] {\n    margin-left: -7px;\n}\n"],sourceRoot:""}])},978:function(module,__webpack_exports__,__webpack_require__){"use strict";(function($){var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__(4),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1__components_static_EditGroupCategory__=__webpack_require__(979),__WEBPACK_IMPORTED_MODULE_2_vue__=__webpack_require__(3),__WEBPACK_IMPORTED_MODULE_3_vue_sortable_tree__=__webpack_require__(45);__WEBPACK_IMPORTED_MODULE_2_vue__.default.component(__WEBPACK_IMPORTED_MODULE_3_vue_sortable_tree__.a.name,__WEBPACK_IMPORTED_MODULE_3_vue_sortable_tree__.a),__webpack_exports__.a={props:["rootId","callback"],data:function(){return{Name:"",Parent:"",ListData:[],viewModel:{},treeData:{Name:"Danh mục nghiệp vụ",children:[],level:"0",Level:"5",Id:this.rootId,collapseIcon:"fa fa-cog",expandIcon:"fa fa-cog"}}},created:function(){var e=this;this.updateDatagroup(),this.init(),this.$hub.$on("update-category-tree",function(){e.updateDatagroup(),e.init()})},destroyed:function(){this.$hub.$off("update-category-tree")},watch:{rootId:function(e){this.treeData.Id=e}},methods:{init:function(){var e=this,t=this.$Lodash.cloneDeep(this.$singleRequest);t.R1_RequestTemplate="Setting.SearchSetting",t.R1_ParentCode="xSetting.Project.Parameter.Organization.Category",t.R1_IncludedNestedSetParent=!0,this.$Utils.post(t).then(function(t){e.ListData=e.$Utils.getDataWithRoot(t.R1,"Data.DynamicDS.Setting"),e.$Utils.isEmpty(e.ListData,"0")&&(e.ParentId=e.$Lodash.cloneDeep(e.ListData[0].Id),e.ListData.shift(),e.PageKey=e.ListData[0],e.getSetting())})},getSetting:function getSetting(){var _this3=this;this.ListData=[];var request=this.$Lodash.cloneDeep(this.$singleRequest);request.R1_RequestTemplate="Setting.SearchSettingTree",request.R1_ParentCode="xSetting.Project.Parameter.Organization.Category",request.R2_RequestTemplate="Setting.SearchSetting",request.R2_ParentCode="xSetting.Project.Parameter.Organization.Category",request.TotalRequests=2,this.$Utils.postCheckResult(request).then(function(data){_this3.treeData.children=_this3.$Utils.getDataWithRoot(data.R1,"Data");var SourceList=_this3.$Utils.getDataWithRoot(data.R2,"Data.DynamicDS.Setting");if(_this3.$Utils.isEmpty(SourceList,"0"))var RootLevel=_this3.$Lodash.cloneDeep(SourceList[0].Level);$.each(SourceList,function(key,value){var index=key-1;_this3.ListData.push(value);var childRank=eval(value.Level-RootLevel);for(_this3.ListData[key].text="";childRank>0;)_this3.ListData[key].text+="|-- ",childRank--;_this3.ListData[key].text+=value.Name})})},changeState:function(e){this.$set(e,"$foldClose",!e.$foldClose)},changePosition:function(e){var t=this,i=this.$Lodash.cloneDeep(this.$singleRequest);if(i.R1_RequestTemplate="Setting.MoveNode",i.R1_Id=e.data.Id,e.afterParent.children&&e.afterParent.children.length>1){var a=0;$.each(e.afterParent.children,function(t,n){n.Id==e.data.Id&&t>0?(a=t-1,i.R1_ReferenceId=e.afterParent.children[a].Id,i.R1_NestedSetType="MoveToAfterAnother"):n.Id==e.data.Id&&0==t&&(a=1,i.R1_ReferenceId=e.afterParent.children[a].Id,i.R1_NestedSetType="MoveToBeforeAnother")})}else i.R1_ReferenceId=e.afterParent.Id,i.R1_NestedSetType="MoveToLastChildNode";this.$Utils.post(i).then(function(i){t.getAllLevel(e.afterParent.Level,e.data),t.$hub.$emit("update-category-tree-form");var a=t.$Lodash.cloneDeep(t.$singleRequest);a.R1_RequestTemplate="AG_Task_Task.Search",a.R1_RequestDataGroup="DataGroup.danh-sach-cong-viec.04b66",a.R1_RequestFields="Id;Index;Categories;CategoriesName;Code;CategoriesLevel1;CategoriesLevel2;CategoriesLevel3;CategoriesLevel4;TargetsLevel1;TargetsLevel2;TargetsLevel3;TargetsLevel4;CategoriesLevel5;CategoriesLevel6;CategoriesLevel7;CategoriesLevel8;CategoriesLevel9;CategoriesLevel10;CategoriesLevel11;CategoriesLevel12",a.R1_Keyword=e.data.Id,t.$Utils.post(a).then(function(i){i=t.$Utils.getDataWithRoot(i.R1,"Data.TasksDS.Task"),t.ListTask=t.$Lodash.cloneDeep(i),t.inputData=[],t.checkParent(e.afterParent,e.data)})})},editCategory:function(e,t){t?this.$hub.$emit("addNewCat",e):this.$hub.$emit("set-modal-data","Sửa nghiệp vụ","40%",!0,"center",__WEBPACK_IMPORTED_MODULE_1__components_static_EditGroupCategory__.a,!0,"",e)},deleteSetting:function(e){var t=this;this.$confirm("Bạn có chắc chắn muốn xóa nghiệp vụ {0} này?".replace("{0}",e.Name),"Cảnh báo",{confirmButtonText:"Xóa",cancelButtonText:"Bỏ qua",type:"warning"}).then(function(){if(t.$Utils.isEmpty(e)){var i=t.$Lodash.cloneDeep(t.ListData);t.deleteItem(e,i)}}).catch(function(){t.$message({type:"info",message:"Lỗi khi xóa"})})},deleteItem:function(e,t){var i=this,a=i.$Lodash.cloneDeep(i.$singleRequest);a.R1_RequestTemplate="Setting.Delete",a.R1_Id=e.Id,i.$Utils.postCheckResult(a).then(function(a){var n=!0;$.each(t,function(a,s){e.Id==s.ParentId&&(i.deleteItem(s,t),n=!1)}),!0===n&&(i.getSetting(),i.$hub.$emit("update-document-category-selecttree"))})},checkExits:function(){var e=this;this.Parent&&""!=this.Parent&&(this.objParent=this.ListData.filter(function(t){return t.Id==e.Parent})[0]);var t=this.$Lodash.cloneDeep(this.$singleRequest);t.R1_RequestTemplate="Setting.SearchSetting",t.R1_ParentCode="xSetting.Project.Parameter.Project.Category",this.$Utils.post(t).then(function(t){var i=e.$Utils.getDataWithRoot(t.R1,"Data.DynamicDS.Setting");i=i.filter(function(t){return t.Name==e.Name}),i.length>0||e.insertSetting()})},insertSetting:function(e){var t=this,i=this.$Lodash.cloneDeep(this.$singleRequest);i.R1_RequestTemplate="Setting.Insert",i.R1_Name=this.Name,i.R1_ValueName=this.data.Name,i.R1_ReferenceId=this.$Utils.isEmpty(this.objParent)?this.objParent.Id:this.ParentId,i.R1_NestedSetType="InsertLastChildNode",this.$Utils.postCheckResult(i).then(function(e){t.$Utils.linkToRoleEveryone([{Id:e.R1.Data,Caption:t.Name}]),t.$Utils.isEmpty(t.objParent,"Level")?t.onSave(t.objParent.Level):t.onSave(5),t.Name=null,t.objParent=null,t.getSetting()})},updateDatagroup:function(){var e=this,t=this.$Lodash.cloneDeep(this.$singleRequest);t.TotalRequests=4,t.R1_RequestTemplate="SettingNew.SearchSetting",t.R1_Code="DataGroup.danh-sach-cong-viec.04b66",t.R2_RequestTemplate="SettingNew.SearchSetting",t.R2_ParentCode="xSetting.Project.Form",t.R2_Level="4",t.R2_Name="DataGroup.danh-sach-cong-viec.04b66",t.R3_RequestTemplate="SettingNew.SearchSetting",t.R3_ParentCode="xSetting.Project.List",t.R3_Level="4",t.R3_Name="DataGroup.danh-sach-cong-viec.04b66",t.R4_RequestTemplate="SettingNew.SearchSetting",t.R4_ParentCode="xSetting.Project.Filter",t.R4_Level="4",t.R4_Name="DataGroup.danh-sach-cong-viec.04b66",this.$Utils.post(t).then(function(t){e.SettingFilter=e.$Utils.getDataWithRoot(t.R1,"Data.DynamicDS.Setting")[0],e.$Utils.isEmpty(e.SettingFilter,"Description")&&"string"==typeof e.SettingFilter.Description&&(e.SettingFilter.Description=JSON.parse(e.SettingFilter.Description)),e.objFields={},e.sortedFilter=[];for(var i=1;i<=e.SettingFilter.Description.FCount;i++)1==i&&(e.FilterSettings=""),e.FilterSettings+=e.SettingFilter["F"+i],i==e.SettingFilter.Description.FCount&&(e.setFilterSetting=!0,e.FilterSetting=JSON.parse(e.FilterSettings),e.SettingFilter.Fields=e.FilterSetting);e.viewModel.ListModules=e.$Utils.getDataWithRoot(t.R2,"Data.DynamicDS.Setting"),e.viewModel.ListModules=e.viewModel.ListModules.concat(e.$Utils.getDataWithRoot(t.R3,"Data.DynamicDS.Setting")),e.viewModel.ListModules=e.viewModel.ListModules.concat(e.$Utils.getDataWithRoot(t.R4,"Data.DynamicDS.Setting")),e.viewModel.ListModules.forEach(function(e){if(void 0!=e.Description){e.Description=JSON.parse(e.Description),e.ObjectFields="";for(var t=1;t<=e.Description.OFCount;t++)void 0!=e["OF"+t]&&(e.ObjectFields+=e["OF"+t]);e.ObjectFields=JSON.parse(e.ObjectFields)}}),e.DatagroupSource=e.$Lodash.cloneDeep(e.viewModel.ListModules)})},onSave:function(e,t){var i=this,a=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.SettingFilter.Fields);if(e-=4,-1==a.indexOf("CategoriesLevel"+e)){var n={Caption:"Danh mục phòng ban cấp "+e,DataSource:"xDynamicData_Setting",FieldColumnType:"String",FieldStorageType:"Struct",FilterIsUsed:"true",FormDisplay:"- Danh mục phòng ban cấp "+e+" -",FormFieldType:"Hidden",FormIncludeSubmit:"true",FormValidate:"",ListButtonGroups:"",ListIsHidden:"true",Name:"CategoriesLevel"+e,PlaceHolder:"- Danh mục phòng ban "+e+" -",ReportIsUsed:"true"};this.SettingFilter.Fields.push(n),a=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.SettingFilter.Fields);var s=JSON.parse(this.SettingFilter.Value),o={Name:"CategoriesLevel"+e,ColumnType:"String",StorageType:"Struct"};s.push(o),this.SettingFilter.Value=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(s),this.sourceFields=this.$Lodash.cloneDeep(this.SettingFilter.Fields),delete this.SettingFilter.Fields;var r=0;this.SettingFilter.Description.FCount=0;for(var l=1;l<7;l++)a.length>r&&(this.SettingFilter["F"+l]=a.substring(r,r+9999),r=1e4*l-l,this.SettingFilter.Description.FCount=l);if(this.SettingFilter.Description=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.SettingFilter.Description),!this.$Utils.isEmpty(t)||0==t){var c=this.$Lodash.cloneDeep(this.$singleRequest);this.$Utils.updateParamsSingleRequest(c,this.$Lodash.cloneDeep(this.SettingFilter)),c.R1_RequestTemplate="SettingNew.Update",this.$Utils.post(c).then(function(e){i.saveModules()})}}},saveModules:function(){var e=this,t=this.$Lodash.cloneDeep(this.SettingFilter);t.Description=JSON.parse(t.Description),t.Description.Fields=this.$Lodash.cloneDeep(this.sourceFields);var i=this.$Lodash.cloneDeep(this.viewModel.ListModules),a=this.$Lodash.cloneDeep(this.$singleRequest);a.TotalRequests=0,i.forEach(function(i){a.TotalRequests++,i.ModuleType=i.Value,i.Description.DataGroupCaption=t.Caption,i.Description.RootData=t.Description.RootData,i.Description.DataSource=t.Description.DataSource,i.Description.AdditionConditions=t.Description.AdditionConditions,-1!=["Form","Filter","List"].indexOf(i.Description.ModuleType)&&(i.Description.Link=t.Description.Link),-1!=["Form","Filter"].indexOf(i.Description.ModuleType)&&(i.Description.Dependencies=t.Description.Dependencies);var n=["Multicheck","IndexDefault","Tool"];(e.$Lodash.cloneDeep(i.ObjectFields).forEach(function(e){for(var a=!1,s=0;s<t.Description.Fields.length;s++){var o=t.Description.Fields[s];if(e.Name==o.Name){a=!0;break}}-1!=["List"].indexOf(i.Description.ModuleType)&&(-1!=n.indexOf(e.Name)&&(a=!0),"true"==e.ManualCalculator&&(a=!0)),a||($.each(i.ObjectFields,function(t,a){e.Name==a.Name&&i.ObjectFields.splice(t,1)}),void 0!=i.Description.Groups&&i.Description.Groups.forEach(function(t){void 0!=t.ListFields&&-1!=t.ListFields.indexOf(e.Name)&&(t.ListFields=t.ListFields.replace(e.Name+";",""))}))}),e.$Utils.isEmpty(i.Description,"Buttons"))&&(e.$Lodash.cloneDeep(i.Description.Buttons).forEach(function(e){for(var a=!1,n=0;n<t.Description.Buttons.length;n++)t.Description.Buttons[n].Code==e.Code&&(a=!0);a||$.each(i.Description.Buttons,function(t,a){e.Code==a.Code&&i.Description.Buttons.splice(t,1)})}),i.Description.Buttons.forEach(function(e){i.Description.Buttons.forEach(function(t){t.Code==e.Code&&(e=t)})}));if(-1!=["Form","List"].indexOf(i.Description.ModuleType))for(var s=0;s<i.Description.Buttons.length;s++)t.Description.Buttons.forEach(function(e){i.Description.Buttons[s].Code==e.Code&&(i.Description.Buttons[s]=e)});i.Fields=e.$Lodash.cloneDeep(i.ObjectFields),i.Fields.forEach(function(i){t.Description.Fields.forEach(function(t){t.Name==i.Name&&($.each(t,function(t,a){e.$Utils.isEmpty(i[t])||(i[t]=a)}),e.$Utils.deleteAutoValue(i))})}),-1!=["Form","Filter"].indexOf(i.Description.ModuleType)?t.Description.Fields.forEach(function(t){e.$Utils.deleteAutoValue(t),"Hidden"==t.FormFieldType&&i.Fields.push(t),void 0!=t.DynamicText&&null!=t.DynamicText&&i.Fields.push({Name:t.DynamicText,FieldStorageType:"Dynamic"})}):t.Description.Fields.forEach(function(t){e.$Utils.deleteAutoValue(t),"true"==t.ListIsHidden&&i.Fields.push(t),void 0!=t.DynamicText&&null!=t.DynamicText&&i.Fields.push({Name:t.DynamicText,FieldStorageType:"Dynamic"})}),i.ObjectFields=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(i.ObjectFields);for(var o=0,r=0,s=1;s<7;s++)i.ObjectFields.length>o&&(i["OF"+s]=i.ObjectFields.substring(o,o+9999),o=1e4*s-s,r=s);i.Description.OFCount=r,delete i.ObjectFields,o=0,r=0,i.Fields=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(i.Fields);for(var s=1;s<7;s++)i.Fields.length>o&&(i["F"+s]=i.Fields.substring(o,o+9999),o=1e4*s-s,r=s);i.Description.FCount=r,delete i.Fields,i.Description=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(i.Description),a=e.$Utils.updateParamsSingleRequest(a,i,a.TotalRequests),a=e.$Utils.updateParamsSingleRequest(a,{RequestTemplate:"SettingNew.Update"},a.TotalRequests)}),this.$Utils.post(a).then(function(t){e.updateDatagroup()})},getAllLevel:function getAllLevel(parent,data){this.onSave(eval(parent)+1),this.$Utils.isEmpty(data.children)&&this.getAllLevel(eval(parent)+1,data.children)},checkParent:function(e){var t=this;if(this.$Utils.isEmpty(e,"$parent")){var i=this.$Lodash.cloneDeep(e.$parent);delete e.$parent,this.inputData.unshift(i),this.checkParent(e.$parent)}else{var a=this.$Lodash.cloneDeep(this.$singleRequest);a.TotalRequests=0,$.each(this.ListTask,function(e,i){if(t.$Utils.isEmpty(i,"CategoriesName")&&""!=i.Categories){var n=!1,s=t.$Lodash.cloneDeep(t.inputData),o=t.$Utils.isEmpty(i,"CategoriesName")?i.CategoriesName.split(";"):[];$.each(i.Categories.split(";"),function(e,i){if(""!=i){if(1==n){var a={};a.Id=i,a.Name=o[e],s.push(a)}i==t.inputData[t.inputData.length-1].Id&&(n=!0)}}),1==n&&(a["R"+[a.TotalRequests+1]+"_RequestTemplate"]="AG_Task_Task.Update",a["R"+[a.TotalRequests+1]+"_RequestDataGroup"]="DataGroup.danh-sach-cong-viec.04b66",a["R"+[a.TotalRequests+1]+"_RequestFields"]="Id;Index;Categories;Code;",a["R"+[a.TotalRequests+1]+"_Categories"]="",a["R"+[a.TotalRequests+1]+"_CategoriesName"]="",a["R"+[a.TotalRequests+1]+"_Id"]=i.Id,$.each(s,function(e,t){a["R"+[a.TotalRequests+1]+"_Categories"]+=e.Id+";",a["R"+[a.TotalRequests+1]+"_CategoriesName"]+=e.Name+";",a["R"+[a.TotalRequests+1]+"_CategoriesLevel"+[t+1]]=e.Id,a["R"+[a.TotalRequests+1]+"_RequestFields"]+="CategoriesLevel"+[t+1]+";"}),a.TotalRequests++)}}),this.$Utils.post(a)}}}}}).call(__webpack_exports__,__webpack_require__(2))},979:function(e,t,i){"use strict";function a(e){i(980)}var n=i(982),s=i(983),o=i(0),r=a,l=o(n.a,s.a,!1,r,null,null);t.a=l.exports},980:function(e,t,i){var a=i(981);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i(937)("ec397dbc",a,!0)},981:function(e,t,i){t=e.exports=i(936)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"EditGroupCategory.vue",sourceRoot:""}])},982:function(e,t,i){"use strict";t.a={props:["data"],components:{},data:function(){return{categorie:this.data.Name,groups:[],valueGroup:[],valueGroupName:"",valueGroupId:"",categories:[],itemCate:""}},created:function(){var e=this;if(this.$Utils.isEmpty(this.data.Value)){this.data.Value.split(";").forEach(function(t){t.length>1&&e.valueGroup.push(t)})}},mounted:function(){this.getGroups()},methods:{getGroups:function(){var e=this,t={RequestClass:"xBase",RequestAction:"Request",TotalRequests:1,R1_RequestTemplate:"OrgnizationList",R1_GroupType:1};this.$Utils.post(t).then(function(t){e.groups=e.$Utils.getDataWithRoot(t.R1,"Data.UserDS.Group")})},updateCate:function(){var e=this;this.groups.forEach(function(t){e.valueGroup.forEach(function(i){i==t.GroupId&&(e.valueGroupName+=t.GroupName,e.valueGroupId+=i+";")})});var t={RequestClass:"xBase",RequestAction:"Request",TotalRequests:1,R1_RequestTemplate:"Setting.MigrateSetting",R1_Id:this.data.Id,R1_Level:this.data.Level,R1_Name:this.categorie,R1_ParentId:this.data.ParentId,R1_$$mdSelectId:this.data.$treeNodeId,R1_oldName:this.categorie,R1_Value:this.valueGroupId,R1_ValueName:this.valueGroupName};this.$Utils.postCheckResult(t).then(function(t){t.success&&(e.$message({message:"Cập nhật thành công",type:"success"}),e.$hub.$emit("update-category-tree"),e.closeForm())})},loadCategories:function(){var e=this,t={RequestClass:"xBase",RequestAction:"Request",TotalRequests:1,R1_RequestTemplate:"Setting.SearchBase",R1_ParentCode:"xSetting.Project.Parameter.Organization.Category"};this.$Utils.post(t).then(function(t){e.categories=t.R1.Data.DynamicDS.Setting})},closeForm:function(){this.$hub.$emit("close-modal")}}}},983:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",[i("el-form-item",{attrs:{label:"Chuyên mục"}},[i("el-input",{attrs:{placeholder:"Chuyên mục"},model:{value:e.categorie,callback:function(t){e.categorie=t},expression:"categorie"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Thuộc phòng ban"}},[e.groups&&e.groups.length>0?i("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"Chọn phòng ban"},model:{value:e.valueGroup,callback:function(t){e.valueGroup=t},expression:"valueGroup"}},e._l(e.groups,function(e){return i("el-option",{key:e.GroupId,attrs:{label:e.GroupName,value:e.GroupId}})})):e._e()],1),e._v(" "),i("el-form-item",[i("el-col",{attrs:{span:8}},[e._v(" ")]),e._v(" "),i("el-col",{attrs:{span:8}},[i("el-button",{attrs:{type:"primary"},on:{click:e.updateCate}},[e._v("Lưu")]),e._v(" "),i("el-button",{on:{click:e.closeForm}},[e._v("Đóng")])],1),e._v(" "),i("el-col",{attrs:{span:8}},[e._v(" ")])],1)],1)],1)},n=[],s={render:a,staticRenderFns:n};t.a=s},984:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"group-categories"},[i("b-card",[i("sortable-tree",{attrs:{data:e.treeData,mixinParentKey:"$parent",dragEnable:!0,closeStateKey:"$foldClose"},on:{changePosition:e.changePosition},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.item;return[i("div",{staticClass:"custom-tree-content",class:{exitChild:a.children&&a.children.length}},[a.$foldClose&&a.children&&a.children.length?i("span",{on:{click:function(t){e.changeState(a)}}},[e._v("▶")]):!a.$foldClose&&a.children&&a.children.length?i("span",{on:{click:function(t){e.changeState(a)}}},[e._v("▼")]):e._e(),e._v(" "),"0"!=a.level?i("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){e.editCategory(a,!1)}}},[e._v(e._s(a.Name))]):i("span",[e._v(e._s(a.Name))]),e._v(" "),i("span",[i("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){e.editCategory(a,!0)}}},[i("i",{staticClass:"fa fa-plus"})]),e._v(" "),"0"!=a.level?i("a",{attrs:{href:"javascript:void(0)"},on:{click:function(t){e.deleteSetting(a)}}},[e._v("\n                |"),i("i",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"}})]):e._e()])])]}}])})],1)],1)},n=[],s={render:a,staticRenderFns:n};t.a=s},985:function(e,t,i){"use strict";var a=i(986),n=i(987),s=i(0),o=s(a.a,n.a,!1,null,null,null);t.a=o.exports},986:function(e,t,i){"use strict";(function(e){var a=i(4),n=i.n(a),s=i(106),o=i(31);t.a={props:["groupcategories","rootId","callback","grcategories","parent"],data:function(){return{ParentCategory:this.parent?this.parent.Id:"",formInline:{Name:"",Group:[],ParentCategory:this.parent?[this.parent.Id]:[],isDisable:!1},grcate:[],groups:[],SelectedCategory:[],SelectedGroup:[],rotateGroups:[],SettingFilter:{},viewModel:{},Value:[]}},components:{SelectCheck:s.a,SelectTree:o.a},methods:{setParent:function(t){var i=this,a={};e.each(this.groupcategories,function(e,i){if(t[0]===i.Id)return void(a.Value=i.Value)});var n=this;n.Value=[],n.formInline.Group=n.Value,this.formInline.isDisable=!1,a&&(e.each(n.groups,function(t,s){a.Value&&(e.each(a.Value.split(";"),function(e,t){a&&s.GroupId==t&&n.Value.push(s.GroupId)}),i.formInline.isDisable=!0)}),n.Value.length>0&&(n.formInline.Group=n.Value))},loadGroups:function(){var e=this,t={RequestClass:"xBase",RequestAction:"Request",TotalRequests:1,R1_RequestTemplate:"OrgnizationList",R1_GroupType:1};this.$Utils.post(t).then(function(t){t.success&&(e.groups=e.$Utils.getDataWithRoot(t.R1,"Data.UserDS.Group"),e.rotateGroups=e.$Utils.rotateDementionArr(e.groups,"GroupId"))})},loadCategories:function(){var e={RequestClass:"xBase",RequestAction:"Request",TotalRequests:1,R1_RequestTemplate:"SettingNew.SearchSetting",R1_ParentCode:"xSetting.Project.Parameter.Organization.Category",R1_GroupType:1};this.$Utils.post(e).then(function(e){e.data.success})},childUpdate:function(e){this.Group=e},childTreeUpdate:function(e){},onSubmit:function(){this.checkExits()},checkExits:function(e){var t=this;if(""==this.formInline.Name)this.$message.error("Tên Nghiệp vụ không được để trống");else{var i=this.$Lodash.cloneDeep(this.$singleRequest);i.R1_RequestTemplate="Setting.SearchSetting",i.R1_ParentCode="xSetting.Project.Parameter.Organization.Category",i.R1_Name=t.formInline.Name,i.R1_ReferenceId=t.$Utils.isEmpty(t.formInline.ParentCategory)?t.formInline.ParentCategory[t.formInline.ParentCategory.length-1]:t.rootId,i.R1_NestedSetType="InsertLastChildNode",i.R1_IncludedNestedSetParent=!0,t.$Utils.post(i).then(function(i){var a=t.$Utils.getDataWithRoot(i.R1,"Data.DynamicDS.Setting");a=a.filter(function(e){return e.Name==t.Name}),a.length>0?t.$message.error("Danh mục phòng ban đã tồn tại."):t.insertSetting(e)})}},insertSetting:function(e){var t=this,i=this;if(""==this.formInline.Name)this.$Utils.showMessage("error","Tên Nghiệp vụ không được để trống");else{var a=i.$Lodash.cloneDeep(i.$singleRequest);a.R1_RequestTemplate="Setting.Insert",a.R1_Name=i.formInline.Name,a.R1_Value=i.Value.join(";"),a.R1_ReferenceId=i.formInline.ParentCategory.length>0?i.formInline.ParentCategory[i.formInline.ParentCategory.length-1]:i.rootId,a.R1_NestedSetType="InsertLastChildNode",i.$Utils.postCheckResult(a).then(function(n){if(i.$Utils.linkToRoleEveryone([{Id:n.R1.Data,Caption:i.formInline.Name}]),i.$Utils.isEmpty(i.rotateGroups[a.R1_ReferenceId],"Level")?i.onSave(i.rotateGroups[a.R1_ReferenceId].Level):i.onSave(5),i.$Utils.isEmpty(e)){var s={};s.Id=n.R1.Data,i.$Utils.isEmpty(i.formInline.Name)&&(s.Name=i.$Utils.clone(i.formInline.Name)),i.$Utils.isEmpty("")&&(s.Value="",s.ValueName="")}t.$message.success("Nghiệp vụ {0} thành công.".replace("{0}",i.formInline.Name)),i.formInline.Name="",i.formInline.Group=[],i.formInline.ParentCategory=[],t.$hub.$emit("update-category-tree")})}},onSave:function(e,t){var i=this,a=n()(i.SettingFilter.Fields);if(e-=4,-1==a.indexOf("CategoriesLevel"+e)){var s={Caption:"Danh mục phòng ban cấp "+e,DataSource:"xDynamicData_Setting",FieldColumnType:"String",FieldStorageType:"Struct",FilterIsUsed:"true",FormDisplay:"- Danh mục phòng ban cấp "+e+" -",FormFieldType:"Hidden",FormIncludeSubmit:"true",FormValidate:"",ListButtonGroups:"",ListIsHidden:"true",Name:"CategoriesLevel"+e,PlaceHolder:"- Danh mục phòng ban "+e+" -",ReportIsUsed:"true"};i.SettingFilter.Fields.push(s),a=n()(i.SettingFilter.Fields);var o=JSON.parse(i.SettingFilter.Value),r={Name:"CategoriesLevel"+e,ColumnType:"String",StorageType:"Struct"};o.push(r),i.SettingFilter.Value=n()(o),i.sourceFields=i.$Lodash.cloneDeep(i.SettingFilter.Fields),delete i.SettingFilter.Fields;var l=0;i.SettingFilter.Description.FCount=0;for(var c=1;c<7;c++)a.length>l&&(i.SettingFilter["F"+c]=a.substring(l,l+9999),l=1e4*c-c,i.SettingFilter.Description.FCount=c);if(i.SettingFilter.Description=n()(i.SettingFilter.Description),!i.$Utils.isEmpty(t)||0==t){var u=angular.copy(singleRequest);i.$Utils.updateParamsSingleRequest(u,angular.copy(i.SettingFilter)),u.R1_RequestTemplate="SettingNew.Update",i.$Utils.post(u).then(function(e){i.saveModules()})}}},saveModules:function(){var t=this,i=t.$Lodash.cloneDeep(t.SettingFilter);i.Description=JSON.parse(i.Description),i.Description.Fields=t.$Lodash.cloneDeep(t.sourceFields);var a=t.$Lodash.cloneDeep(t.viewModel.ListModules),s=t.$Lodash.cloneDeep(t.$singleRequest);s.TotalRequests=0,e.each(a,function(a,o){s.TotalRequests++,o.ModuleType=o.Value,o.Description.DataGroupCaption=i.Caption,o.Description.RootData=i.Description.RootData,o.Description.DataSource=i.Description.DataSource,o.Description.AdditionConditions=i.Description.AdditionConditions,-1!=["Form","Filter","List"].indexOf(o.Description.ModuleType)&&(o.Description.Link=i.Description.Link),-1!=["Form","Filter"].indexOf(o.Description.ModuleType)&&(o.Description.Dependencies=i.Description.Dependencies);var r=t.$Lodash.cloneDeep(o.ObjectFields),l=["Multicheck","IndexDefault","Tool"];e.each(r,function(t,a){for(var n=!1,s=0;s<i.Description.Fields.length;s++){var r=i.Description.Fields[s];if(a.Name==r.Name){n=!0;break}}-1!=["List"].indexOf(o.Description.ModuleType)&&(-1!=l.indexOf(a.Name)&&(n=!0),"true"==a.ManualCalculator&&(n=!0)),n||(e.each(o.ObjectFields,function(e,t){a.Name==t.Name&&o.ObjectFields.splice(e,1)}),void 0!=o.Description.Groups&&e.each(o.Description.Groups,function(e,t){void 0!=t.ListFields&&-1!=t.ListFields.indexOf(a.Name)&&(t.ListFields=t.ListFields.replace(a.Name+";",""))}))});var c=angular.copy(o.Description.Buttons);if(e.each(c,function(t,a){for(var n=!1,s=0;s<i.Description.Buttons.length;s++){i.Description.Buttons[s].Code==a.Code&&(n=!0)}n||e.each(o.Description.Buttons,function(e,t){a.Code==t.Code&&o.Description.Buttons.splice(e,1)})}),e.each(o.Description.Buttons,function(t,i){e.each(o.Description.Buttons,function(e,t){t.Code==i.Code&&(i=t)})}),-1!=["Form","List"].indexOf(o.Description.ModuleType))for(var u=0;u<o.Description.Buttons.length;u++)e.each(i.Description.Buttons,function(e,t){o.Description.Buttons[u].Code==t.Code&&(o.Description.Buttons[u]=t)});o.Fields=angular.copy(o.ObjectFields),e.each(o.Fields,function(a,n){e.each(i.Description.Fields,function(i,a){a.Name==n.Name&&(e.each(a,function(e,i){t.$Utils.isEmpty(n[e])||(n[e]=i)}),t.$Utils.deleteAutoValue(n))})}),-1!=["Form","Filter"].indexOf(o.Description.ModuleType)?e.each(i.Description.Fields,function(e,i){t.$Utils.deleteAutoValue(i),"Hidden"==i.FormFieldType&&o.Fields.push(i),void 0!=i.DynamicText&&null!=i.DynamicText&&o.Fields.push({Name:i.DynamicText,FieldStorageType:"Dynamic"})}):e.each(i.Description.Fields,function(e){t.$Utils.deleteAutoValue(e),"true"==e.ListIsHidden&&o.Fields.push(e),void 0!=e.DynamicText&&null!=e.DynamicText&&o.Fields.push({Name:e.DynamicText,FieldStorageType:"Dynamic"})}),o.ObjectFields=n()(o.ObjectFields);for(var d=0,p=0,u=1;u<7;u++)o.ObjectFields.length>d&&(o["OF"+u]=o.ObjectFields.substring(d,d+9999),d=1e4*u-u,p=u);o.Description.OFCount=p,delete o.ObjectFields,d=0,p=0,o.Fields=n()(o.Fields);for(var u=1;u<7;u++)o.Fields.length>d&&(o["F"+u]=o.Fields.substring(d,d+9999),d=1e4*u-u,p=u);o.Description.FCount=p,delete o.Fields,o.Description=n()(o.Description),s=t.$Utils.updateParamsSingleRequest(s,o,s.TotalRequests),s=t.$Utils.updateParamsSingleRequest(s,{RequestTemplate:"SettingNew.Update"},s.TotalRequests)}),t.$Utils.post(s).then(function(e){t.updateDatagroup()})},updateDatagroup:function(){var t=this,i=t.$Lodash.cloneDeep(this.$singleRequest);i.TotalRequests=4,i.R1_RequestTemplate="SettingNew.SearchSetting",i.R1_Code="DataGroup.danh-sach-cong-viec.04b66",i.R2_RequestTemplate="SettingNew.SearchSetting",i.R2_ParentCode="xSetting.Project.Form",i.R2_Level="4",i.R2_Name="DataGroup.danh-sach-cong-viec.04b66",i.R3_RequestTemplate="SettingNew.SearchSetting",i.R3_ParentCode="xSetting.Project.List",i.R3_Level="4",i.R3_Name="DataGroup.danh-sach-cong-viec.04b66",i.R4_RequestTemplate="SettingNew.SearchSetting",i.R4_ParentCode="xSetting.Project.Filter",i.R4_Level="4",i.R4_Name="DataGroup.danh-sach-cong-viec.04b66",t.$Utils.post(i).then(function(i){t.SettingFilter=t.$Utils.getDataWithRoot(i.R1,"Data.DynamicDS.Setting")[0],t.$Utils.isEmpty(t.SettingFilter,"Description")&&"string"==typeof t.SettingFilter.Description&&(t.SettingFilter.Description=JSON.parse(t.SettingFilter.Description)),t.objFields={},t.sortedFilter=[];for(var a=1;a<=t.SettingFilter.Description.FCount;a++)1==a&&(t.FilterSettings=""),t.FilterSettings+=t.SettingFilter["F"+a],a==t.SettingFilter.Description.FCount&&(t.setFilterSetting=!0,t.FilterSetting=JSON.parse(t.FilterSettings),t.SettingFilter.Fields=t.FilterSetting);t.viewModel.ListModules=t.$Utils.getDataWithRoot(i.R2,"Data.DynamicDS.Setting"),t.viewModel.ListModules=t.viewModel.ListModules.concat(t.$Utils.getDataWithRoot(i.R3,"Data.DynamicDS.Setting")),t.viewModel.ListModules=t.viewModel.ListModules.concat(t.$Utils.getDataWithRoot(i.R4,"Data.DynamicDS.Setting")),e.each(t.viewModel.ListModules,function(e,t){if(void 0!=t.Description){t.Description=JSON.parse(t.Description),t.ObjectFields="";for(var i=1;i<=t.Description.OFCount;i++)void 0!=t["OF"+i]&&(t.ObjectFields+=t["OF"+i]);t.ObjectFields=JSON.parse(t.ObjectFields)}}),t.DatagroupSource=t.$Lodash.cloneDeep(t.viewModel.ListModules)})},loadGroupcategories:function(){var t=this.grcategories;e.each(t,function(e,i){if(i.Level){var a=i.Level;for(t[e].Name="";a>6;)t[e].Name+="|-- ",a--;t[e].Name+=i.Name}})}},created:function(){this.updateDatagroup(),this.loadGroups(),this.loadGroupcategories(),this.parent&&this.parent.Value&&(this.Value=this.parent.Value.split(";").filter(function(e){return e.length>0}))},watch:{}}}).call(t,i(2))},987:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{attrs:{inline:!e.parent,"label-width":"130px",model:e.formInline}},[i("el-form-item",{attrs:{label:"Tên nghiệp vụ",required:""}},[i("el-input",{attrs:{placeholder:"Tên nghiệp vụ"},model:{value:e.formInline.Name,callback:function(t){e.$set(e.formInline,"Name",t)},expression:"formInline.Name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Nghiệp vụ cha"}},[e.parent?i("el-select",{attrs:{disabled:e.formInline.isDisable,placeholder:"Chọn"},model:{value:e.ParentCategory,callback:function(t){e.ParentCategory=t},expression:"ParentCategory"}},[i("el-option",{attrs:{label:e.parent.Name,value:e.parent.Id}})],1):i("el-cascader",{attrs:{options:e.groupcategories,placeholder:"Chọn","change-on-select":"",clearable:""},on:{change:function(t){e.setParent(e.formInline.ParentCategory)}},model:{value:e.formInline.ParentCategory,callback:function(t){e.$set(e.formInline,"ParentCategory",t)},expression:"formInline.ParentCategory"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Thuộc phòng ban"}},[i("el-select",{attrs:{multiple:"",clearable:"",disabled:e.formInline.isDisable,placeholder:"Chọn"},model:{value:e.Value,callback:function(t){e.Value=t},expression:"Value"}},e._l(e.groups,function(e){return i("el-option",{key:e.GroupId,attrs:{label:e.GroupName,value:e.GroupId}})}))],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("Lưu")])],1)],1)},n=[],s={render:a,staticRenderFns:n};t.a=s},988:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.centerDialogVisible?i("el-dialog",{attrs:{title:"Thêm nghiệp vụ",visible:e.centerDialogVisible,width:e.$isMobileDevice?"100%":"30%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t},close:e.closeDialog}},[i("span",[i("CreateGroupCategoryForm",{attrs:{groupcategories:e.categoriesTree,grcategories:e.categories,rootId:e.rootId,callback:e.loadCategories,parent:e.item}})],1)]):e._e(),e._v(" "),i("CreateGroupCategoryForm",{attrs:{groupcategories:e.categoriesTree,grcategories:e.categories,rootId:e.rootId,callback:e.loadCategories}}),e._v(" "),i("GroupCategoryTree",{attrs:{callback:e.loadCategories,rootId:e.rootId},on:{"update:rootId":function(t){e.rootId=t}}})],1)},n=[],s={render:a,staticRenderFns:n};t.a=s}});
//# sourceMappingURL=0.a095efb19a1fd35a8256.js.map
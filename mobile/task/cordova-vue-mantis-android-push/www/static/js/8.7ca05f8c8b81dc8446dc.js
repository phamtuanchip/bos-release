webpackJsonp([8],{1185:function(e,t,a){var o=a(1186);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a(937)("5a971d94",o,!0)},1186:function(e,t,a){t=e.exports=a(936)(!0),t.push([e.i,".document-list .row{margin-right:-10px;margin-left:-10px}.document-list .el-tabs__content{max-height:78vh;overflow-y:scroll}.document-list .el-table__body-wrapper,.document-list .el-table__empty-block{height:79vh!important}@media screen and (max-width:599px) and (max-width:375px){.document-list .el-table__body-wrapper,.document-list .el-table__empty-block{height:76vh!important}}@media screen and (max-width:599px){.document-list .el-table__body-wrapper,.document-list .el-table__empty-block{height:78vh!important}}.document-list .el-tabs__item,.document-list .el-tabs__nav-wrap.is-scrollable{padding:0 10px}.document-list .search{width:222px}.document-list .sc-table .tool-bar{margin:3px 0}.document-list .el-tabs__header{margin:0}.document-list #Filter{height:100%}.document-list #Filter .modal-dialog{position:fixed;right:0;margin:0;height:100%}.document-list #Filter .modal-dialog .modal-content{height:100%}.document-list .title-box{background-color:#f0f3f5;border:1px solid #c2cfd6}.document-list .createDocument .el-dialog__header{text-align:left;background-color:#5090c1}.document-list .createDocument .el-dialog__header .el-dialog__title{color:#fff}.document-list .createDocument .el-dialog__footer{text-align:right}.document-list .createDocument .el-dialog__headerbtn .el-dialog__close{color:#fff}.document-list .el-aside{color:#333}.document-list .border-box{border:1px solid #d3d3d3}.document-list .my-row .col-md-9{padding:0!important}.document-list .my-header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;background-color:#f0f3f5;padding:0 10px 3px;cursor:pointer}","",{version:3,sources:["/Users/yuukininomae/Sites/vue-crm3/src/components/Documents.vue"],names:[],mappings:"AACA,oBACE,mBAAoB,AACpB,iBAAmB,CACpB,AACD,iCACE,gBAAiB,AACjB,iBAAmB,CACpB,AACD,6EACE,qBAAwB,CACzB,AACD,0DACA,6EACI,qBAAwB,CAC3B,CACA,AACD,oCACA,6EACI,qBAAwB,CAC3B,CACA,AAID,8EACE,cAAkB,CACnB,AACD,uBACE,WAAa,CACd,AACD,mCACE,YAAwB,CACzB,AACD,gCACE,QAAU,CACX,AACD,uBACE,WAAa,CACd,AACD,qCACI,eAAgB,AAChB,QAAW,AACX,SAAY,AACZ,WAAa,CAChB,AACD,oDACM,WAAa,CAClB,AACD,0BACE,yBAA0B,AAC1B,wBAA0B,CAC3B,AACD,kDACE,gBAAiB,AACjB,wBAA0B,CAC3B,AACD,oEACI,UAAY,CACf,AACD,kDACE,gBAAkB,CACnB,AACD,uEACE,UAAY,CACb,AACD,yBACE,UAAY,CACb,AACD,2BACE,wBAA4B,CAC7B,AACD,iCACE,mBAAwB,CACzB,AACD,0BACE,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,yBAA0B,AACtB,sBAAuB,AACnB,8BAA+B,AACvC,yBAA0B,AAE1B,mBAAyB,AACzB,cAAgB,CACjB",file:"Documents.vue",sourcesContent:["\n.document-list .row {\n  margin-right: -10px;\n  margin-left: -10px;\n}\n.document-list .el-tabs__content {\n  max-height: 78vh;\n  overflow-y: scroll;\n}\n.document-list .el-table__empty-block, .document-list .el-table__body-wrapper {\n  height: 79vh !important;\n}\n@media screen and (max-width: 599px) and (max-width: 375px) {\n.document-list .el-table__empty-block, .document-list .el-table__body-wrapper {\n    height: 76vh !important;\n}\n}\n@media screen and (max-width: 599px) {\n.document-list .el-table__empty-block, .document-list .el-table__body-wrapper {\n    height: 78vh !important;\n}\n}\n.document-list .el-tabs__nav-wrap.is-scrollable {\n  padding: 0px 10px;\n}\n.document-list .el-tabs__item {\n  padding: 0px 10px;\n}\n.document-list .search {\n  width: 222px;\n}\n.document-list .sc-table .tool-bar {\n  margin: 3px 0px 3px 0px;\n}\n.document-list .el-tabs__header {\n  margin: 0;\n}\n.document-list #Filter {\n  height: 100%;\n}\n.document-list #Filter .modal-dialog {\n    position: fixed;\n    right: 0px;\n    margin: 0px;\n    height: 100%;\n}\n.document-list #Filter .modal-dialog .modal-content {\n      height: 100%;\n}\n.document-list .title-box {\n  background-color: #f0f3f5;\n  border: 1px solid #c2cfd6;\n}\n.document-list .createDocument .el-dialog__header {\n  text-align: left;\n  background-color: #5090c1;\n}\n.document-list .createDocument .el-dialog__header .el-dialog__title {\n    color: #fff;\n}\n.document-list .createDocument .el-dialog__footer {\n  text-align: right;\n}\n.document-list .createDocument .el-dialog__headerbtn .el-dialog__close {\n  color: #fff;\n}\n.document-list .el-aside {\n  color: #333;\n}\n.document-list .border-box {\n  border: 1px solid lightgray;\n}\n.document-list .my-row .col-md-9 {\n  padding: 0px !important;\n}\n.document-list .my-header {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  background-color: #f0f3f5;\n  /*border: 1px solid #c2cfd6;*/\n  padding: 0 10px 3px 10px;\n  cursor: pointer;\n}\n"],sourceRoot:""}])},1187:function(e,t,a){"use strict";(function(e){var o=a(4),i=a.n(o),n=a(44),s=a.n(n),r=a(1188),l=a(1193),c=a(1198),u=a(16),d=a(283);t.a={name:"categories",components:{CreateDocumentForm:r.a,DocumentTree:l.a,PermissionSelector:u.a,Pagination:d.a},data:function(){var e;return e={totalP:0,currentP:1,maxItem:this.$getItemLocalStorage("PageSize")?parseInt(this.$getItemLocalStorage("PageSize")):10,documentCategoriesTmp:[],projectTmp:[],groupTmp:[],dateTmp:[],completedSignal:0,currentTab:0,isCollapse:!1,currentUser:this.$rootScope.loggedOnUser,arrPermission:{},tableProps:{"empty-text":"Không có dữ liệu"},searchDef:{inputProps:{placeholder:"Tìm kiếm tài liệu"},colProps:{span:12}},listButtons:[],showButton:!1,ListField:[],titles:[],dialogVisible:!1,activeName:"1",projects:[],years:[],documentCategories:[],documentTypeList:[],groups:[],dates:[],filterTree:[],treeData:[{label:"Phòng ban",objKey:"GroupId",requestKey:"Project",outputListKey:"groups",children:[],type:"group",icon:"icon-people",unread:0,total:0,isSynchronized:!0},{label:"Danh mục",objKey:"Id",requestKey:"SettingCategory",outputListKey:"documentCategories",children:[],type:"group",icon:"icon-notebook",unread:0,total:0,isSynchronized:!0},{label:"Dự án",objKey:"Id",requestKey:"VersionProject",outputListKey:"projects",children:[],type:"project",icon:"icon-drawer",unread:0,total:0,isSynchronized:!0}],SettingForm:[],options:[],form:{Keyword:"",Created:[],PublishedDate:[]},documentList:[],tableData:[],categories:[]},s()(e,"projects",[]),s()(e,"versionProjects",[]),s()(e,"Types",[]),s()(e,"inputArr",[]),e},methods:{handleSizeChange:function(e){this.$setItemLocalStorage("PageSize",e),this.maxItem=e,this.getDocumentToFillTable(this.inputArr,this.treeData[this.currentTab],!0)},handleSelectPage:function(e){this.currentP=e,this.getDocumentToFillTable(this.inputArr,this.treeData[this.currentTab],!0)},shareDocument:function(e){this.$hub.$emit("set-modal-data","Chia sẻ tài liệu","80%",!0,"left",u.a,!0,"",e.Id)},handleClick:function(e,t){this.$hub.$emit("resetChecked"),this.tableData=[],this.currentTab=e.paneName,this.treeData[e.paneName].isSynchronized&&this.getBagNumber(this.treeData[e.paneName],!0)},handleNodeClick:function(){},clearInput:function(){this.form.Keyword="",this.form.Created=[],this.form.PublishedDate=[]},searchSetting:function(){var t=this,a={RequestClass:"xBase",RequestAction:"Request",TotalRequests:2,R1_RequestTemplate:"SettingNew.SearchSetting",R1_Code:"Form.cap-nhat-tai-lieu.0b27c",R2_RequestTemplate:"SettingNew.SearchSetting",R2_Code:"List.danh-sach-tai-lieu.064hg;"};this.$Utils.post(a).then(function(a){var o=[];o["icon-delete"]="fa fa-trash",o["icon-plus-circle"]="fa fa-plus-circle",o["icon-pencil-box"]="fa fa-pencil",o["icon-eye"]="fa fa-eye",o["icon-briefcase-download"]="fa fa-download",o["icon-share ic"]="fa fa-share";var n=t.$Utils.getDataWithRoot(a.R2,"Data.DynamicDS.Setting")[0];t.$Utils.isEmpty(n,"Description")&&t.$Lodash.isString(n.Description)&&(n.Description=JSON.parse(n.Description)),e.each(n.Description,function(e,t){n[e]=t}),t.SettingForm=n;var s=t.SettingForm.Description.Buttons;t.completedSignal+=1,e.each(s,function(a,n){n.Icon=o[n.Icon],n.UserPermissions&&n.UserPermissions.length>0&&n.UserPermissions.forEach(function(e){i()(t.currentUser.Roles).indexOf(e)>-1&&(n.DisplayPermit=!0)});var s=t.$Utils.stringToObject(n.ExtraSetting);e.each(s,function(e,t){n[e]=t})}),s=s.filter(function(e){return"Insert"!==e.ButtonDisplayType}),t.listButtons=t.$Lodash.cloneDeep(s);var r=JSON.parse(n.OF1);t.ListFields=t.$Lodash.cloneDeep(r);var l=[];e.each(r,function(e,t){"Name"!==t.Name&&"Tool"!==t.Name&&l.push({prop:t.Name,label:t.Caption})}),t.titles=t.$Lodash.cloneDeep(l)})},onButtonClick:function(e,t){this.excuteButtonClick(this.listButtons[e],t)},checkPermit:function(t,a){var o=this,n=!1,s=!1;return t.PermitToShow&&this.arrPermission&&this.$Utils.isEmpty(this.arrPermission[a.Id],t.PermitToShow)?-1!=this.arrPermission[a.Id][t.PermitToShow].indexOf(this.currentUser.UserId)?n=!0:e.each(this.arrPermission[a.Id][t.PermitToShow],function(e,t){if(i()(o.currentUser.Roles).indexOf(t)>-1)return n=!0,!1}):t.PermitToShow||(n=!0),(t.UserPermissions&&t.DisplayPermit||!t.UserPermissions||0==t.UserPermissions.length)&&(s=!0),n&&s&&this.showButton},excuteButtonClick:function(e,t){var a=e.ButtonType?e.ButtonType:e.ElementType;switch(!e.ButtonType&&"Link"==e.ElementType&&e.Redirect&&(a="Redirect"),a){case"Click":switch(e.Action){case"Update":this.excuteUpdate(t,e);break;case"Delete":this.excuteDelete(t,e);break;case"ReturnData":break;case"Download":this.excuteDownload(e,t);break;case"Audio":this.excuteAudio(e,t);break;case"Call":break;case"Permission":this.shareDocument(t)}}},excuteDownload:function(e,t){var a=this,o=this,i=[],n=0,s={RequestClass:"xBase",RequestAction:"SearchBinary",Parent:t.Id,ConditionFields:"Parent",StaticFields:"Name;Created;Modified;FileName;FileExtension;FileSize;CreatedBy;Description;Parent;FileSize",DynamicFields:"CreatedByName;SignatureVerified"};o.$Utils.postCheckResult(s).then(function(e){i=o.$Utils.getDataWithRoot(e,"Data.DynamicDS.Binary"),n=e.TotalCount,a.$hub.$emit("set-modal-data","Chia sẻ tài liệu","80%",!0,"left",c.a,!0,"",i)})},excuteDelete:function(e,t){var a=this;a.$confirm("Hành động này không thể hoàn tác. Bạn thực sự muốn xóa bản ghi này?","Cảnh Báo",{confirmButtonText:"Xóa",cancelButtonText:"Bỏ qua",type:"warning"}).then(function(){a.$Utils.isEmpty(e,"length")||(e=[e]),a.sendDeleteRequest(e,t)})},sendDeleteRequest:function(t,a){var o=this,i={RequestClass:"xBase",RequestAction:"Request",TotalRequests:t.length,RequestTemplate:"xDocument_Document.Delete"};e.each(t,function(e,t){i["R"+(e+1)+"_Id"]=t.Id,i["R"+(e+1)+"_DeleteReferenceData"]=t.Id}),o.$Utils.postCheckResult(i).then(function(a){e.each(t,function(e,t){t.Name?t.Name:t.Id;a["R"+(e+1)].success?(o.$Utils.showMessage("success","Xóa Thành công"),o.tableData=o.tableData.filter(function(e){return e.Id!=t.Id})):o.$Utils.showMessage("error","Có lỗi xảy ra")})})},searchList:function(){this.getBagNumber(this.treeData[this.currentTab],!0),this.$refs.Filter.hide()},getBagNumber:function(t,a){for(var o=this,i=this.$Lodash.cloneDeep(t.children),n=t.outputListKey,s=t.objKey,r=t.requestKey,l={RequestClass:"xBase",RequestAction:"Request",TotalRequests:i.length},c=1;c<=i.length;c++)l["R"+c+"_RequestTemplate"]="xDocument_Document.Count",l["R"+c+"_RequestDataGroup"]="DataGroup.tai-lieu-dung-chung.0cb59",l["R"+c+"_Code"]="Document",void 0!=r&&(l["R"+c+"_"+r]=i[c-1][s]),l["R"+c+"_AssignedUser"]=this.$getItemLocalStorage(this.$localStorageConstant.SessionId),a&&e.each(this.form,function(e,t){void 0==t||""==t||null==t||("Keyword"==e?l["R"+c+"_"+e]=t:2==t.length&&(l["R"+c+"_"+e+"StartValue"]=o.$Utils.formatDateTime(t[0]),l["R"+c+"_"+e+"EndValue"]=o.$Utils.formatDateTime(t[1],"YYYY-MM-DDT23:59:59")))});i.length>0?this.$Utils.postCheckResult(l).then(function(e){for(var t=1;t<=i.length;t++)i[t-1].total=e["R"+t].Data;o[n]=i}):this[n]=[]},reloadDataLst:function(){var t=this,a=this;this.tableData=e.map(a.documentList,function(e){var o={Name:e.Name,FileTypeName:e.FileTypeName?t.mapFileTypeName(e.FileTypeName):"",Created:a.$Utils.formatDateTime(e.Created,"DD/MM/YYYY"),CreatedBy:e.CreatedByName,Category:e.CategoryName,Project:e.ProjectName,VersionProject:e.VersionProjectName,Id:e.Id,btnLst:{}};return a.listButtons.forEach(function(t){o.btnLst[t.Code]=a.checkPermit(t,{Id:e.Id})}),o})},mapFileTypeName:function(e){return this.documentTypeList.filter(function(t){return t.Name===e})[0].Value},getDocumentType:function(){var e=this,t={RequestClass:"xBase",RequestAction:"Request",TotalRequests:1,R1_RequestTemplate:"Setting.SearchBase",R1_ParentCode:"xSetting.Project.Parameter.DocumentView.DocumentType",SessionId:localStorage.getItem("SessionId")};this.$Utils.post(t).then(function(t){e.documentTypeList=e.$Lodash.cloneDeep(e.$Utils.getDataWithRoot(t.R1,"Data.DynamicDS.Setting"))})},searchTreeData:function(){var e=this,t={RequestClass:"xBase",RequestAction:"Request",TotalRequests:3,R1_RequestTemplate:"SettingNew.SearchSetting",R1_ParentCode:"xSetting.Project.Parameter.Category",R2_RequestTemplate:"tblGroup.Search",R2_RequestDataGroup:"DataGroup.quan-ly-du-an.053gf",R2_RequestFields:"GroupId;GroupName;Status;GroupType;GroupParent",R2_GroupType:4,R3_RequestTemplate:"tblGroup.Search",R3_GroupType:1,R3_RequestDataGroup:"DataGroup.quan-ly-du-an.053gf",R3_RequestFields:"GroupId;GroupName;GroupType;"};this.$isSystemAdmin()||this.$isMantisAdmin()||(t.R3_AssignedUser=this.$getItemLocalStorage(this.$localStorageConstant.SessionId)),this.$Utils.post(t).then(function(t){e.treeData[1].children=e.$Utils.getDataWithRoot(t.R1,"Data.DynamicDS.Setting"),e.treeData[2].children=e.$Utils.getDataWithRoot(t.R2,"Data.UserDS.Group").map(function(e){return{Id:e.GroupId,Name:e.GroupName}}),e.treeData[0].children=e.$Utils.getDataWithRoot(t.R3,"Data.UserDS.Group"),e.getBagNumber(e.treeData[0])})},getDocumentToFillTable:function(t,a,o){var i=this,n=a.objKey,s=a.requestKey,r={RequestClass:"xBase",RequestAction:"Request",TotalRequests:2};r.R1_RequestTemplate="xDocument_Document.Search",r.R1_RequestDataGroup="DataGroup.tai-lieu-dung-chung.0cb59",r.R1_Code="Document",r.R1_RequestFields="Id;Tool;Name;Created;CreatedByName;CreatedBy;CategoryName;SettingCategory;Category;ProjectName;Project;VersionProjectName;VersionProject;ModifiedByName;Code;FileTypeName;TypeName;VersionProjectName;PublishedDate;",r.R1_AssignedUser=this.$getItemLocalStorage(this.$localStorageConstant.SessionId),r.R1_StartIndex=(this.currentP-1)*this.maxItem,r.R1_EndIndex=this.currentP*this.maxItem,r.R2_RequestTemplate="xDocument_Document.Count",r.R2_RequestDataGroup="DataGroup.tai-lieu-dung-chung.0cb59",r.R2_Code="Document",r.R2_RequestFields="Id;Code",r.R2_AssignedUser=this.$getItemLocalStorage(this.$localStorageConstant.SessionId),o&&e.each(this.form,function(e,t){void 0==t||""==t||null==t||("Keyword"==e?(r["R1_"+e]=t,r["R2_"+e]=t):2==t.length&&(r["R1_"+e+"StartValue"]=i.$Utils.formatDateTime(t[0]),r["R1_"+e+"EndValue"]=i.$Utils.formatDateTime(t[1],"YYYY-MM-DDT23:59:59"),r["R2_"+e+"StartValue"]=i.$Utils.formatDateTime(t[0]),r["R2_"+e+"EndValue"]=i.$Utils.formatDateTime(t[1],"YYYY-MM-DDT23:59:59")))}),r["R1_"+s]="",r["R2_"+s]="";for(var l=0;l<t.length;l++)r["R1_"+s]+=t[l][n]+";";r["R2_"+s]=r["R1_"+s],this.$Utils.postCheckResult(r).then(function(t){i.showButton=!1,i.documentList=i.$Utils.getDataWithRoot(t.R1,"Data.DocumentDS.Document"),i.totalP=parseInt(t.R2.Data);var a={RequestClass:"xBase",RequestAction:"Request",TotalRequests:i.documentList.length,RequestTemplate:"Permission"};e.each(i.documentList,function(e,t){i.arrPermission[t.Id]={},a["R"+(e+1)+"_Parent"]=t.Id}),0!==a.TotalRequests?i.$Utils.post(a).then(function(t){e.each(t,function(t,a){a=i.$Utils.getDataWithRoot(a,"Data.DataDS.Linked"),i.$Utils.isEmpty(a)&&a.length>0&&e.each(a,function(e,t){i.$Utils.isEmpty(i.arrPermission[a[0].Parent][t.Code])||(i.arrPermission[a[0].Parent][t.Code]=[]),i.arrPermission[a[0].Parent][t.Code].push(t.Child)})}),i.showButton=!0,i.completedSignal+=1}):i.completedSignal+=1})}},watch:{groups:function(t){var a=this,o=this.$Utils.createCustomTreeFromList(t,"Id","ParentId","children",{GroupName:"label",GroupId:"value"},{type:"group",icon:"icon-folder"});this.treeData[0].total=0,e.each(o,function(e,t){a.treeData[0].total+=parseInt(t.total)}),this.treeData[0].children=o},documentCategories:function(t){var a=this,o=this.$Utils.createCustomTreeFromList(t,"Id","ParentId","children",{Name:"label",Id:"value"},{type:"category",icon:"icon-folder"});this.treeData[1].total=0,e.each(o,function(e,t){a.treeData[1].total+=parseInt(t.total)}),this.treeData[1].children=o},projects:function(e){var t=this.$Utils.createCustomTreeFromList(e,"Id","ParentId","children",{Name:"label",Id:"value"});this.treeData[2].children=t},completedSignal:function(e){e>=2&&this.reloadDataLst()}},created:function(){var e=this;this.getDocumentType(),this.searchSetting(),this.$hub.$on("update-document-list",function(t){e.inputArr=t,0==t.length?e.tableData=[]:e.getDocumentToFillTable(t,e.treeData[e.currentTab])}),this.searchTreeData()},mounted:function(){},destroyed:function(){this.$hub.$off("resetChecked")}}}).call(t,a(2))},1188:function(e,t,a){"use strict";function o(e){a(1189)}var i=a(1191),n=a(1192),s=a(0),r=o,l=s(i.a,n.a,!1,r,null,null);t.a=l.exports},1189:function(e,t,a){var o=a(1190);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a(937)("a1057258",o,!0)},1190:function(e,t,a){t=e.exports=a(936)(!0),t.push([e.i,".documentForm .el-form-item__content{margin-left:0!important}","",{version:3,sources:["/Users/yuukininomae/Sites/vue-crm3/src/components/static/CreateDocumentForm.vue"],names:[],mappings:"AACA,qCACE,uBAA0B,CAC3B",file:"CreateDocumentForm.vue",sourcesContent:["\n.documentForm .el-form-item__content {\n  margin-left: 0 !important;\n}\n"],sourceRoot:""}])},1191:function(e,t,a){"use strict";(function(e){var o=a(4),i=a.n(o),n=a(108);t.a={name:"CreateDocument",props:{value:""},components:{UploadFile:n.a},data:function(){return{userInfor:JSON.parse(this.$Utils.getUserInfo()),SettingForm:null,model:{Id:null,Category:null,Project:{},VersionProject:null,Type:null,Created:null,PublishedDate:null,FileType:null,Name:null,Description:null},config:this.$froOptions,categories:[],projects:[],versionProjects:[],Types:[],FileTypes:[]}},methods:{changeProject:function(){},onSubmit:function(){var t=this,a={RequestClass:"xBase",RequestAction:"Request",TotalRequests:1,R1_Project:this.model.Project?this.model.Project.GroupId:null,R1_ProjectName:this.model.Project?this.model.Project.GroupName:null,R1_ProjectCode:this.model.Project?this.model.Project.Code:null,R1_RequestFields:"Id;Category;CategoryName;Project;ProjectName;VersionProject;VersionProjectName;Created;PublishedDate;FileType;FileTypeName;Name;Description;Code;Type;CreatedBy;CreatedByName;Modified;ModifiedBy;ModifiedByName;TypeName;FormSetting;Changed;",R1_Category:this.model.Category?this.model.Category.Id:null,R1_CategoryName:this.model.Category?this.model.Category.Name:null,R1_VersionProject:this.model.VersionProject?this.model.VersionProject.GroupId:null,R1_VersionProjectName:this.model.VersionProject?this.model.VersionProject.GroupName:null,R1_Created:t.$Utils.formatDateTime(this.model.Created),R1_PublishedDate:t.$Utils.formatDateTime(this.model.PublishedDate),R1_FileType:this.model.FileType?this.model.FileType.Id:null,R1_FileTypeName:this.model.FileType?this.model.FileType.Name:null,R1_Name:this.model.Name,R1_Description:this.model.Description,R1_RequestDataGroup:"DataGroup.tai-lieu-dung-chung.0cb59",R1_RequestTemplate:"xDocument_Document.Insert",R1_CreatedByName:this.userInfor.Username,R1_ModifiedByName:this.userInfor.Username,R1_Version:1,R1_Code:"Document",R1_FormSetting:i()(t.SettingForm)};e.each(a,function(e,o){t.$Utils.isEmpty(o)||delete a[e]}),t.$Utils.post(a).then(function(e){})},bindTree:function(t,a,o){if(this.$Utils.isEmpty(t)){var i=this.$Lodash.cloneDeep(t);e.each(i,function(e,t){var n=t.Level;for(i[e].text="";n>a;)i[e].text+="|-- ",n--;i[e].text+=t[o]})}return i}},created:function(){var e=this,t=this,a=JSON.parse(this.$Utils.getUserInfo()),o=null;t.$Utils.isEmpty(a,"Project")&&t.$Utils.isEmpty(a.Project,"GroupId")&&(o=a.Project.GroupId);var i={RequestClass:"xBase",RequestAction:"Request",TotalRequests:5,R1_RequestTemplate:"Setting.SearchBase",R1_ParentCode:"xSetting.Project.Parameter.Category",R1_RequestOrderFields:"LeftIndex ASC",R2_RequestTemplate:"OrgnizationList",R2_GroupType:1,R2_AssignedUser:this.$getItemLocalStorage(this.$localStorageConstant.SessionId),R3_RequestTemplate:"tblGroup.Search",R3_RequestDataGroup:"DataGroup.quan-ly-du-an.053gf",R3_RequestFields:"GroupId;GroupName;ProjectCode;GroupType;CreatedBy;State;Status;Type",R3_GroupType:4,R4_RequestTemplate:"Setting.SearchBase",R4_ParentCode:"xSetting.Project.Parameter.DocumentView.DocumentType",R5_RequestTemplate:"Setting.SearchBase",R5_ParentCode:"xSetting.Project.Parameter.Organization.Category",R5_Value:o};t.$Utils.isEmpty(o)&&(i.R1_Project=o),this.$Utils.post(i).then(function(a){var i=t.$Utils.getDataWithRoot(a.R1,"Data.DynamicDS.Setting");i=e.bindTree(i,5,"Name"),e.categories=i;var n=t.$Utils.getDataWithRoot(a.R2,"Data.UserDS.Group");if(n=e.bindTree(n,1,"GroupName"),e.projects=n,t.$Utils.isEmpty(e.projects)){var s=e.projects.find(function(e){return e.GroupId==o});e.model.Project=s}e.versionProjects=t.$Utils.getDataWithRoot(a.R3,"Data.UserDS.Group"),e.FileTypes=t.$Utils.getDataWithRoot(a.R4,"Data.DynamicDS.Setting");var r=t.$Utils.getDataWithRoot(a.R5,"Data.DynamicDS.Setting");e.Types=e.bindTree(r)})},mounted:function(){var t=this;setTimeout(function(){e("a:contains('Unlicensed copy of the Froala Editor')").remove()},900);var a={RequestClass:"xBase",RequestAction:"Request",TotalRequests:1,R1_RequestTemplate:"SettingNew.SearchSetting",R1_Code:"Form.cap-nhat-tai-lieu.0b27c"};this.$Utils.post(a).then(function(a){var o=t.$Utils.getDataWithRoot(a.R1,"Data.DynamicDS.Setting")[0];t.$Utils.isEmpty(o,"Description")&&t.$Lodash.isString(o.Description)&&(o.Description=JSON.parse(o.Description)),e.each(o.Description,function(e,t){o[t]=e}),t.SettingForm=o})}}}).call(t,a(2))},1192:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",staticClass:"documentForm",attrs:{model:e.model,"label-width":"120px"}},[a("el-form-item",[a("el-col",{attrs:{span:12}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"Danh mục"},model:{value:e.model.Category,callback:function(t){e.$set(e.model,"Category",t)},expression:"model.Category"}},e._l(e.categories,function(e){return a("el-option",{key:e.Id,attrs:{label:e.text,value:e}})}))],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"Phòng ban"},on:{change:e.changeProject},model:{value:e.model.Project,callback:function(t){e.$set(e.model,"Project",t)},expression:"model.Project"}},e._l(e.projects,function(e){return a("el-option",{key:e.GroupId,attrs:{label:e.text,value:e.GroupId,"value-key":e}})}))],1)],1),e._v(" "),a("el-form-item",[a("el-col",{attrs:{span:12}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"Dự án"},model:{value:e.model.VersionProject,callback:function(t){e.$set(e.model,"VersionProject",t)},expression:"model.VersionProject"}},e._l(e.versionProjects,function(e){return a("el-option",{key:e.GroupId,attrs:{label:e.GroupName,value:e}})}))],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"Nghiệp vụ"},model:{value:e.model.Type,callback:function(t){e.$set(e.model,"Type",t)},expression:"model.Type"}},e._l(e.Types,function(e){return a("el-option",{key:e.Id,attrs:{label:e.Name,value:e}})}))],1)],1),e._v(" "),a("el-form-item",[a("el-col",{attrs:{span:12}},[a("el-date-picker",{staticStyle:{width:"90%"},attrs:{type:"date",placeholder:"Ngày tạo",format:"dd-MM-yyyy"},model:{value:e.model.Created,callback:function(t){e.$set(e.model,"Created",t)},expression:"model.Created"}})],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-date-picker",{staticStyle:{width:"90%"},attrs:{type:"date",placeholder:"Ngày phát hành",format:"dd-MM-yyyy"},model:{value:e.model.PublishedDate,callback:function(t){e.$set(e.model,"PublishedDate",t)},expression:"model.PublishedDate"}})],1)],1),e._v(" "),a("el-form-item",[a("el-col",{attrs:{span:12}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"Phân loại"},model:{value:e.model.FileType,callback:function(t){e.$set(e.model,"FileType",t)},expression:"model.FileType"}},e._l(e.FileTypes,function(e){return a("el-option",{key:e.Id,attrs:{label:e.Name,value:e}})}))],1)],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"Tên tài liệu"},model:{value:e.model.Name,callback:function(t){e.$set(e.model,"Name",t)},expression:"model.Name"}})],1),e._v(" "),a("el-form-item",[a("froala",{attrs:{tag:"textarea",config:e.config},model:{value:e.model.Description,callback:function(t){e.$set(e.model,"Description",t)},expression:"model.Description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Tài liệu đính kèm"}},[a("UploadFile")],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("Create")]),e._v(" "),a("el-button",[e._v("Cancel")])],1)],1)},i=[],n={render:o,staticRenderFns:i};t.a=n},1193:function(e,t,a){"use strict";function o(e){a(1194)}var i=a(1196),n=a(1197),s=a(0),r=o,l=s(i.a,n.a,!1,r,null,null);t.a=l.exports},1194:function(e,t,a){var o=a(1195);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a(937)("564212ea",o,!0)},1195:function(e,t,a){t=e.exports=a(936)(!0),t.push([e.i,".document-tree .el-tree-node__expand-icon{font-size:24px}.document-tree .el-checkbox{margin-bottom:0}","",{version:3,sources:["/Users/yuukininomae/Sites/vue-crm3/src/components/static/DocumentTree.vue"],names:[],mappings:"AACA,0CACE,cAAgB,CACjB,AACD,4BACE,eAAmB,CACpB",file:"DocumentTree.vue",sourcesContent:["\n.document-tree .el-tree-node__expand-icon {\n  font-size: 24px;\n}\n.document-tree .el-checkbox {\n  margin-bottom: 0px;\n}\n"],sourceRoot:""}])},1196:function(e,t,a){"use strict";var o=a(4),i=a.n(o);t.a={props:["datasource"],data:function(){return{source:[],isExpanded:!1,defaultProps:{children:"children",label:"label",type:"type"},filterText:""}},watch:{filterText:function(e){this.$refs.tree.filter(e)},datasource:function(e){this.source=e}},methods:{resetChecked:function(){this.$refs.tree.setCheckedKeys([])},handleNodeClick:function(e){var t=this.$refs.tree.getCheckedKeys();-1===t.indexOf(e.value)?(t.push(e.value),this.$refs.tree.setCheckedKeys(t)):(t.splice(t.indexOf(e.value),1),this.$refs.tree.setCheckedKeys(t))},handleCheckChange:function(e,t,a){var o=this.$refs.tree.getCheckedNodes();this.$hub.$emit("update-document-list",o)},filterNode:function(e,t){return!e||-1!==t.label.toLowerCase().indexOf(e.toLowerCase())},remove:function(e,t){var a=e.parent,o=a.data.children||a.data,i=o.findIndex(function(e){return e.id===t.id});o.splice(i,1)},expandAll:function(){this.$refs.tree.$data.store.defaultExpandAll=!0,this.source=JSON.parse(i()(this.source)),this.isExpanded=!0},collapseAll:function(){this.$refs.tree.$data.store.defaultExpandAll=!1,this.source=JSON.parse(i()(this.source)),this.isExpanded=!1},renderContent:function(e,t){var a=t.node;t.data,t.store;return e("span",{style:"flex: 1; display: flex; align-items: center; justify-content: space-between; font-size: 14px; padding-right: 8px;"},[e("span",null,[e("span",null,[e("i",{class:a.data.icon},[]),a.label])]),e("span",null,[this.$Utils.isEmpty(a.data.total)?"("+a.data.total+")":""])])}},created:function(){var e=this;this.$hub.$on("resetChecked",function(){e.resetChecked()})}}},1197:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"document-tree"},[a("div",{staticClass:"row",staticStyle:{"margin-top":"4px"}},[a("div",{staticClass:"col-8"},[a("el-input",{attrs:{placeholder:"Tìm kiếm"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}})],1),e._v(" "),a("div",{staticClass:"col-auto"},[e.isExpanded?a("span",{staticClass:"btn-link",on:{click:e.collapseAll}},[a("i",{staticClass:"el-tree-node__expand-icon el-icon-caret-right expanded",staticStyle:{"font-size":"17px !important"}}),e._v("Thu gọn")]):a("span",{staticClass:"btn-link",on:{click:e.expandAll}},[a("i",{staticClass:"el-tree-node__expand-icon el-icon-caret-right",staticStyle:{"font-size":"17px !important"}}),e._v("Mở rộng")])])]),e._v(" "),a("el-tree",{ref:"tree",attrs:{data:e.source,"show-checkbox":"","node-key":"value","default-expand-all":!(e.$isMobileDevice&&!e.$isMobile.iPad()),"check-strictly":"","highlight-current":"","expand-on-click-node":!1,"filter-node-method":e.filterNode,"render-content":e.renderContent},on:{"node-click":e.handleNodeClick,"check-change":e.handleCheckChange}})],1)},i=[],n={render:o,staticRenderFns:i};t.a=n},1198:function(e,t,a){"use strict";function o(e){a(1199)}var i=a(1201),n=a(1202),s=a(0),r=o,l=s(i.a,n.a,!1,r,null,null);t.a=l.exports},1199:function(e,t,a){var o=a(1200);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a(937)("17b420a7",o,!0)},1200:function(e,t,a){t=e.exports=a(936)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"Download.vue",sourceRoot:""}])},1201:function(e,t,a){"use strict";t.a={props:["data"],data:function(){return{datasource:this.data,base:this.$appUri.BaseURL,currentUser:JSON.parse(localStorage.getItem("LoggedOnUser")).UserId}},methods:{},created:function(){}}},1202:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"download"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:this.datasource,stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"STT",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"FileName",label:"Tên file"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$isMobileDevice?a("a",[e._v(e._s(t.row.FileName))]):a("a",{attrs:{href:e.base+"Download.ashx?Id="+t.row.Id,target:"_blank"}},[e._v(e._s(t.row.FileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"CreatedByName",label:"Người Tạo"}}),e._v(" "),a("el-table-column",{attrs:{prop:"FileExtension",label:"Loại"}}),e._v(" "),a("el-table-column",{attrs:{label:"Dung lượng"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(parseFloat(t.row.FileSize/1024e3).toFixed(2))+" MB\n      ")]}}])}),e._v(" "),e.$isMobileDevice?e._e():a("el-table-column",{attrs:{label:"Hành động"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{href:e.base+"Download.ashx?Id="+t.row.Id,target:"_blank"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"}})],1)]}}])})],1)],1)},i=[],n={render:o,staticRenderFns:i};t.a=n},1203:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"animated fadeIn document-list"},[e.$isMobileDevice&&!e.$isMobile.iPad()?e._e():a("div",{staticClass:"page-header mb-2"},[a("div",{staticClass:"title-box py-1 px-3"},[a("div",{staticClass:"row"},[e._m(0,!1,!1),e._v(" "),a("div",{staticClass:"col text-right pr-0"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Thêm tài liệu",placement:"top"}},[a("router-link",{staticClass:"el-button el-button--mini",attrs:{to:"dynamic/knowhow-add-new-document"}},[a("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),a("button",{directives:[{name:"b-modal",rawName:"v-b-modal.Filter",modifiers:{Filter:!0}}],staticClass:"btn btn-link "},[a("i",{staticClass:"fa fa-filter fa-lg"})])],1)])])]),e._v(" "),a("div",{class:(e.$isMobileDevice?"":"row")+" my-row"},[a("div",{staticClass:"col-md-3 p-0 border-box"},[a("div",{staticClass:"my-header d-md-none d-lg-none d-xl-none"},[a("el-row",{staticStyle:{width:"100%"}},[a("el-col",{attrs:{span:12}},[a("span",[a("i",{staticClass:"fa fa-folder-o fa-lg pr-1"}),e._v("Tài liệu")])]),e._v(" "),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[a("router-link",{attrs:{to:"dynamic/knowhow-add-new-document"}},[a("i",{staticClass:"fa fa-plus fa-lg pr-1"})]),e._v(" "),a("i",{directives:[{name:"b-modal",rawName:"v-b-modal.Filter",modifiers:{Filter:!0}}],staticClass:"fa fa-filter fa-lg pr-1"}),e._v(" "),a("span",{staticClass:"pr-1",on:{click:function(t){e.isCollapse=!e.isCollapse}}},[e.isCollapse?e._e():a("i",{staticClass:"fa fa-lg fa-caret-up"}),e._v(" "),e.isCollapse?a("i",{staticClass:"fa fa-lg fa-caret-down"}):e._e()])],1)],1)],1),e._v(" "),a("div",[a("el-tabs",{directives:[{name:"show",rawName:"v-show",value:!e.isCollapse,expression:"!isCollapse"}],attrs:{type:"card"},on:{"tab-click":e.handleClick}},e._l(e.treeData,function(e){return a("el-tab-pane",{attrs:{label:e.label,name:e.code}},[a("DocumentTree",{attrs:{datasource:e.children}})],1)}))],1)]),e._v(" "),a("div",{staticClass:"col-md-9"},[a("el-container",{staticClass:"border-box bg-white"},[a("el-main",{staticClass:"p-0"},[a("el-table",{attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"Công cụ",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"row pl-1"},e._l(e.listButtons,function(o,i){return t.row.btnLst[o.Code]?a("div",{key:i},["Redirect"==o.ButtonType||"Popup"==o.ButtonType?a("router-link",{staticClass:"btn btn-link p-0 pr-1",attrs:{to:e.$Utils.expressionToString(t.row,o.Redirect),id:"exButton"+i+t.row.Id}},[a("i",{class:o.Icon,attrs:{"aria-hidden":"true"}}),e._v(" "),a("b-tooltip",{attrs:{target:"exButton"+i+t.row.Id,placement:"bottom"}},[e._v("\n                        "+e._s(o.Description?o.Description:o.Caption)+"\n                      ")])],1):e._e(),e._v(" "),"Redirect"!=o.ButtonType&&"Popup"!=o.ButtonType?a("b-button",{staticClass:"p-0 pr-1",attrs:{id:"exButton"+i+t.row.Id,variant:"link","aria-label":""},on:{click:function(a){e.onButtonClick(i,t.row)}}},[a("i",{class:o.Icon,attrs:{"aria-hidden":"true"}}),e._v(" "),a("b-tooltip",{attrs:{target:"exButton"+i+t.row.Id,placement:"bottom"}},[e._v("\n                        "+e._s(o.Description?o.Description:o.Caption)+"\n                      ")])],1):e._e()],1):e._e()}))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Tiêu đề",prop:"Name"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"row pl-1"},[a("label",[a("i",{class:t.row.FileTypeName}),e._v(" --- "+e._s(t.row.Name))])])]}}])}),e._v(" "),e._l(e.titles,function(e){return a("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label,width:"VersionProject"===e.prop?"180":90}})})],2),e._v(" "),e.tableData.length>0?a("Pagination",{attrs:{totalPage:e.totalP,currentPage:e.currentP,pagesize:e.maxItem,pagesizes:[10,25,50,100,1e3],callback:e.handleSelectPage,sizeChanged:e.handleSizeChange}}):e._e()],1)],1)],1)]),e._v(" "),a("b-modal",{ref:"Filter",attrs:{id:"Filter",title:"Bộ lọc","header-bg-variant":"primary","hide-footer":""}},[[a("el-form",{attrs:{"label-position":"top"}},[a("el-form-item",{staticClass:"text-center"},[a("el-button",{on:{click:e.searchList}},[e._v("Tìm kiếm")]),e._v(" "),a("el-button",{on:{click:function(t){e.clearInput()}}},[e._v("Xóa trắng")])],1),e._v(" "),a("el-form-item",{attrs:{label:"Từ khóa"}},[a("el-input",{attrs:{placeholder:"Nhập từ khóa"},model:{value:e.form.Keyword,callback:function(t){e.$set(e.form,"Keyword",t)},expression:"form.Keyword"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"Ngày tạo"}},[a("el-date-picker",{staticStyle:{"max-width":"100%"},attrs:{type:"daterange","popper-class":e.$isMobileDevice?"MobileDateRange":"",placeholder:"Ngày tạo"},model:{value:e.form.Created,callback:function(t){e.$set(e.form,"Created",t)},expression:"form.Created"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"Ngày phát hành"}},[a("el-date-picker",{staticStyle:{"max-width":"100%"},attrs:{"popper-class":e.$isMobileDevice?"MobileDateRange":"",type:"daterange",placeholder:"Ngày phát hành"},model:{value:e.form.PublishedDate,callback:function(t){e.$set(e.form,"PublishedDate",t)},expression:"form.PublishedDate"}})],1)],1)]],2)],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("h5",{staticClass:"col m-auto"},[a("i",{staticClass:"fa fa-folder-o"}),a("span",[e._v("  Tài liệu")])])}],n={render:o,staticRenderFns:i};t.a=n},962:function(e,t,a){"use strict";function o(e){a(1185)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(1187),n=a(1203),s=a(0),r=o,l=s(i.a,n.a,!1,r,null,null);t.default=l.exports}});
//# sourceMappingURL=8.7ca05f8c8b81dc8446dc.js.map